<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<title>Emacs Trick</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="Emacs Trick"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2013-04-30 14:08:48 中国标准时间"/>
<meta name="author" content="visayafan"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>


<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>


<div id="content">
<h1 class="title">Emacs Trick</h1>


<!-- <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"> </script> -->
<link rel="stylesheet" type="text/css" href="../../Layout/CSS/bootstrap_old.css" />
<link rel="stylesheet" type="text/css" href="../../Layout/CSS/too_many_toc.css" />
<script src="../../Layout/JS/jquery_1.7.1.js"></script>
<script src="../../Layout/JS/bootstrap_old.js"></script>


<div id="table-of-contents">
<h2>目录</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 用grep在文件中查找</a>
<ul>
<li><a href="#sec-1-1">1.1 lgrep</a></li>
<li><a href="#sec-1-2">1.2 grep</a></li>
</ul>
</li>
<li><a href="#sec-2">2 执行shell命令</a></li>
<li><a href="#sec-3">3 multiple-cursors</a></li>
<li><a href="#sec-4">4 ace-jump-mode</a></li>
<li><a href="#sec-5">5 align/align-regexp</a></li>
<li><a href="#sec-6">6 occur, re-builder, multi-occur, multi-occur-in-matching-buffers</a></li>
<li><a href="#sec-7">7 apropos</a></li>
<li><a href="#sec-8">8 follow-mode</a></li>
<li><a href="#sec-9">9 hexl-mode</a></li>
<li><a href="#sec-10">10 backup-by-copying-when-linked</a></li>
<li><a href="#sec-11">11 zap-to-char</a></li>
<li><a href="#sec-12">12 fill-paragraph</a></li>
<li><a href="#sec-13">13 <code>/sudo::/</code></a></li>
<li><a href="#sec-14">14 正则表达式</a></li>
<li><a href="#sec-15">15 eshell 别名/使用.bashrc中定义的别名</a></li>
<li><a href="#sec-16">16 Ubuntu安装Emacs24.2及配置CEDET,ECB</a>
<ul>
<li><a href="#sec-16-1">16.1 ./configure前需要安装的信赖包</a></li>
<li><a href="#sec-16-2">16.2 配置cedet, ecb</a></li>
</ul>
</li>
<li><a href="#sec-17">17 dired-mode下批量修改文件名</a></li>
<li><a href="#sec-18">18 Emacs中使用输入法</a></li>
<li><a href="#sec-19">19 乱码</a></li>
<li><a href="#sec-20">20 Yasnippet共享</a></li>
<li><a href="#sec-21">21 Yasnippet中使用elisp制定模板</a></li>
<li><a href="#sec-22">22 eshell命令大小写不敏感</a></li>
<li><a href="#sec-23">23 win7下find问题</a></li>
<li><a href="#sec-24">24 CC-Mode</a></li>
<li><a href="#sec-25">25 Emacs Client启动后字体不正常和tabber不能使用解决办法</a></li>
<li><a href="#sec-26">26 Emacs Gnus 阅读新闻组</a></li>
<li><a href="#sec-27">27 Emacs Org-Mode 写文章做笔记</a></li>
<li><a href="#sec-28">28 Emacs 搜索总结</a></li>
<li><a href="#sec-29">29 Emacs Compile 出现乱码</a></li>
<li><a href="#sec-30">30 Emacs M-x 目录操作</a></li>
<li><a href="#sec-31">31 查看当前buffer所有mode帮助信息</a></li>
<li><a href="#sec-32">32 利用CEDET生成UML</a></li>
<li><a href="#sec-33">33 颜色</a></li>
<li><a href="#sec-34">34 find-name-dired</a></li>
<li><a href="#sec-35">35 ECB</a>
<ul>
<li><a href="#sec-35-1">35.1 自定义ECB窗口宽度</a></li>
<li><a href="#sec-35-2">35.2 自定义ECB布局</a></li>
</ul>
</li>
<li><a href="#sec-36">36 为新mode实现auto complete</a></li>
<li><a href="#sec-37">37 sgml-pretty-print格式化html文件</a></li>
<li><a href="#sec-38">38 HTML中输入特殊字符</a></li>
<li><a href="#sec-39">39 cscope</a></li>
<li><a href="#sec-40">40 退出时session mode提示select-coding-system</a></li>
<li><a href="#sec-41">41 Emacs下德语引号</a></li>
<li><a href="#sec-42">42 设置face</a></li>
<li><a href="#sec-43">43 添加环境变量</a></li>
<li><a href="#sec-44">44 编译指定目录下所有el文件为elc</a></li>
<li><a href="#sec-45">45 查看当前buffer所有mode</a></li>
<li><a href="#sec-46">46 autoload</a></li>
<li><a href="#sec-47">47 eval-after-load</a>
<ul>
<li><a href="#sec-47-1">47.1 eval-after-load和mode hook的区别</a></li>
</ul>
</li>
<li><a href="#sec-48">48 查看.emacs中各语句执行时间</a></li>
<li><a href="#sec-49">49 electri-pair-mode</a></li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 用grep在文件中查找</h2>
<div class="outline-text-2" id="text-1">

<p>  可以直接在grep buffer中修改文件。<br/>
</p>
</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> lgrep</h3>
<div class="outline-text-3" id="text-1-1">




<pre class="example">(lgrep REGEXP &amp;optional FILES DIR CONFIRM)
</pre>

<p>
   查找指定目录DIR下指定模式文件FILES内容中符合REGEXP的文件，GREP buffer中n/p上下选择。<br/>
</p></div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> grep</h3>
<div class="outline-text-3" id="text-1-2">

<p>   指定文件中查找<br/>
</p>


<pre class="example">grep -nH -e "pattern" filename
</pre>

<p>
   其中H表输出中包含文件名，n表输出中包含行号，e表紧跟模式<br/>
</p></div>
</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> 执行shell命令</h2>
<div class="outline-text-2" id="text-2">

<p>  M-! 执行shell命令<br/>
  加前缀C-u执行命令的结果作用在buffer上。<br/>
  类似C-u M-|结果作用在region上<br/>
</p></div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> multiple-cursors</h2>
<div class="outline-text-2" id="text-3">




<pre class="example">(global-set-key (kbd "C-S-c C-S-c") 'mc/edit-lines)
(global-set-key (kbd "C-S-c C-e") 'mc/edit-ends-of-lines)
(global-set-key (kbd "C-S-c C-a") 'mc/edit-beginnings-of-lines)
(global-set-key (kbd "C-&gt;") 'mc/mark-next-like-this)
(global-set-key (kbd "C-&lt;") 'mc/mark-previous-like-this)
(global-set-key (kbd "C-S-c C-&lt;") 'mc/mark-all-like-this)
(global-set-key (kbd "C-S-c C-&gt;") 'mc/mark-all-in-region)
</pre>

<p>
  先选中一个region，mc/edit-lines则对该region每行都有一个光标。mc/mark-next-like-this在与region内容相同的下一处加一光标。其它函数同理。<br/>
</p></div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> ace-jump-mode</h2>
<div class="outline-text-2" id="text-4">




<pre class="src src-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ace-jump-mode</span>)
(<span style="color: #a020f0;">define-key</span> global-map (kbd <span style="color: #8b2252;">"C-c SPC"</span>) 'ace-jump-mode)
</pre>

<p>
  ace-jump-mode共有3个子模式，char, word和line,默认是word，加上前缀C-u是char,两个前缀C-u C-u是line.<br/>
  word模式只匹配以输入字符开头的单词，line模式在非空行行首显示字符以便跳转到想要到的行。<br/>
</p></div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> align/align-regexp</h2>
<div class="outline-text-2" id="text-5">

<p>  满足指定正则表达式的对齐，有时对整理注释比较有用。<br/>
  比较有用的是变量声明的对齐：<br/>
</p>


<pre class="src src-c"><span style="color: #228b22;">int</span> <span style="color: #a0522d;">a</span>;
<span style="color: #228b22;">char</span> <span style="color: #a0522d;">c</span>;
<span style="color: #228b22;">string</span> <span style="color: #a0522d;">str</span>;
</pre>

<p>
  选中后 <code>M-x align</code> 效果：<br/>
</p>


<pre class="src src-c++"><span style="color: #228b22;">int</span>    <span style="color: #a0522d;">a</span>;
<span style="color: #228b22;">char</span>   <span style="color: #a0522d;">c</span>;
<span style="color: #228b22;">string</span> <span style="color: #a0522d;">str</span>;
</pre>

<p>
  其它用法：<a href="http://emacswiki.org/emacs/AlignCommands">EmacsWiki</a><br/>
</p></div>

</div>

<div id="outline-container-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> occur, re-builder, multi-occur, multi-occur-in-matching-buffers</h2>
<div class="outline-text-2" id="text-6">

<p>  list-matching-lines是occur的别名，列出当前buffer中所有满足指定正则表达式的行。<br/>
  在进行正则替换行为确保万无一失，先检查一下，occur后输入regexp则会显示所有匹配内容。<br/>
  加前缀可以显示包含之后/之前N行的额外行。<br/>
  与occur另开一buffer显示匹配不同，re-builder实行动态匹配，即一边在RE-Builder中输入regexp一边匹配（此功能很不错）。<br/>
  在re-builder中C-c C-e可以进入子模式匹配 0―9分别代表子匹配模式，用q退出；还可以C-c TAB来选择正则表达式的语法，默认是read，此模式下需要的转义字符很多可以试下string模式。<br/>
  前面两个都是在当前buffer中匹配，而multi-occur/multi-occur-in-matching-buffers是在多个buffer中匹配<br/>
</p></div>

</div>

<div id="outline-container-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> apropos</h2>
<div class="outline-text-2" id="text-7">

<p>  输入一个regexp，Emacs根据你所输入的regexp和当前buffer的内容构造出更多的regexp，也许Emacs构造的比你的更合适的。<br/>
</p></div>

</div>

<div id="outline-container-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> follow-mode</h2>
<div class="outline-text-2" id="text-8">

<p>  启用该模式后，C-x 3分屏后，一个文件左右连接显示，适合阅读。<br/>
</p></div>

</div>

<div id="outline-container-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> hexl-mode</h2>
<div class="outline-text-2" id="text-9">

<p>  编辑非文本文件。<br/>
</p></div>

</div>

<div id="outline-container-10" class="outline-2">
<h2 id="sec-10"><span class="section-number-2">10</span> backup-by-copying-when-linked</h2>
<div class="outline-text-2" id="text-10">

<p>  当文件存在硬链接时默认的备份会破坏这种链接（新建一个文件在新文件中修改，与原来链接文件的inode不同，故与原来链接文件存在链接关系的文件不会同步更新），可以修改当存在链接的时候,通过拷贝来备份，而不是写进一个新文件，故链接关系不会被破坏。<br/>
</p>


<pre class="example">(setq backup-by-copying-when-linked t)
</pre>

<p>
  如果你在使用dropbox这种方法就非常有用，把想要保存在dropbox中的文件硬链接到dropbox目录下，既不占空间又能保持同步更新。<br/>
</p>
</div>

</div>

<div id="outline-container-11" class="outline-2">
<h2 id="sec-11"><span class="section-number-2">11</span> zap-to-char</h2>
<div class="outline-text-2" id="text-11">

<p>  默认绑定到M-z，删除当前位置到下一个输入字符之间的字符，有时候会很有用。<br/>
</p></div>

</div>

<div id="outline-container-12" class="outline-2">
<h2 id="sec-12"><span class="section-number-2">12</span> fill-paragraph</h2>
<div class="outline-text-2" id="text-12">

<p>  默认绑定到M-q，调整region,不满一行的由下一行补齐,默认宽度由fill-column变量决定。<br/>
</p></div>

</div>

<div id="outline-container-13" class="outline-2">
<h2 id="sec-13"><a name="sudo" id="sudo"></a><span class="section-number-2">13</span> <code>/sudo::/</code></h2>
<div class="outline-text-2" id="text-13">

<p>  如果你用普通用户权限打开emacs，则此时打开超级用户权限的文件是无法修改的，以超级用户重新打开一个emacs可行但考虑到emacs的启动速度，这绝对不是个好主意。<br/>
  解决办法：<br/>
</p><pre class="example">
 C-x C-f /sudo::/ Enter
</pre>

<p>  之后输入密码即可以超级用户权限打开一个文件。<br/>
</p></div>

</div>

<div id="outline-container-14" class="outline-2">
<h2 id="sec-14"><span class="section-number-2">14</span> 正则表达式</h2>
<div class="outline-text-2" id="text-14">

<p>  Emacs中正则表达式要注意group和重复所用的括号需要转义， <code>\(\)</code> , <code>\{3,6\}</code><br/>
  语法类包括：<br/>
</p>


<pre class="example">[:digit:]  a digit, same as [0-9]
[:upper:]  a letter in uppercase
[:space:]  a whitespace character, as defined by the syntax table
[:xdigit:] an hexadecimal digit
[:cntrl:]  a control character
[:ascii:]  an ascii character
\s-   whitespace character        \s/   character example character
\sw   word constituent            \s$   paired delimiter         
\s_   symbol constituent          \s'   expression prefix        
\s.   punctuation character       \s&lt;   comment starter          
\s(   open delimiter character    \s&gt;   comment ender            
\s)   close delimiter character   \s!   generic comment delimiter
\s"   string example character      \s|   generic string delimiter 
\s\   escape character            
</pre>

<p>
  用re-builder查询时要又重转义即转义字符要转义，即上面的要写成\\(\\), \\{3,6\\}，即要匹配一个字面上的\需要4个\，即\\<br/>
  re-builder中[:digit:]在写成[和]要写2次.<br/>
</p>


<pre class="example">"\\(\\+\\|-\\)?[0-9]+\\(\\.[0-9]+\\)?"        表示一个数
"[[:digit:]]\\{3\\}"                          表示连续3个数字
</pre>


</div>

</div>

<div id="outline-container-15" class="outline-2">
<h2 id="sec-15"><span class="section-number-2">15</span> eshell 别名/使用.bashrc中定义的别名</h2>
<div class="outline-text-2" id="text-15">

<p>  Eshell中 find-file filename即可打开文件，等价于C-x C-f filename<br/>
  可以定义别名 alias emacs 'find-file $1'，这样在eshell中emacs filename即可打开文件<br/>
</p>
<p>
  我在.bashrc中定义了许多别名，eshell的别名默认保存在 <code>~/.eshell/alias</code> 中，由变量 <code>eshell-aliases-file</code> 确定，为在方便备份我把它必为 <code>~/.emacs.d/eshell/alias</code> ，为了使eshell可以使用这些别名，可以使用下面的命令把所有在shell中可用的别名加到eshell中。<br/>
</p>


<pre class="example">cd ~/.emacs.d/eshell &amp;&amp; cat alias &gt; tmp &amp;&amp; echo -e "\n" &gt;&gt; tmp &amp;&amp; alias | sed -E "s/^alias ([^=]+)='(.*)'$/alias \1 \2/g; s/'\\\''/'/g;" &gt;&gt; tmp &amp;&amp; sort -u tmp &gt; alias &amp;&amp; rm -f tmp &amp;&amp; sed -i -e '/clc/d' -e '/^$/d'  alias &amp;&amp; cd - &gt;/dev/null
</pre>

<p>
  一个很简单的正则替换，其中最后删掉clc行是因为我在shell下用clc充当clear的别名，而此命令在eshell下无效且影响我定义的另一个名为clc的eshell下的孙：<br/>
</p>


<pre class="src src-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">clc &#28165;&#23631;,&#22312;eshell&#20013;&#36755;&#20837;&#21629;&#20196;&#32780;&#38750;M-x clc</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">eshell/clc</span>()
  <span style="color: #8b2252;">"to clear the eshell buffer."</span>
  (interactive)
  (<span style="color: #a020f0;">let</span> ((inhibit-read-only t))
    (erase-buffer)))
</pre>


<p>  <br/>
</p></div>

</div>

<div id="outline-container-16" class="outline-2">
<h2 id="sec-16"><span class="section-number-2">16</span> Ubuntu安装Emacs24.2及配置CEDET,ECB</h2>
<div class="outline-text-2" id="text-16">


</div>

<div id="outline-container-16-1" class="outline-3">
<h3 id="sec-16-1"><span class="section-number-3">16.1</span> ./configure前需要安装的信赖包</h3>
<div class="outline-text-3" id="text-16-1">




<pre class="example">sudo apt-get install libgtk2.0-dev
sudo apt-get install libxpm-dev  
sudo apt-get install libjpeg62-dev  
sudo apt-get install libgif-dev  
sudo apt-get install libtiff4-dev  
sudo apt-get install libncurses5-dev
</pre>

</div>

</div>

<div id="outline-container-16-2" class="outline-3">
<h3 id="sec-16-2"><span class="section-number-3">16.2</span> 配置cedet, ecb</h3>
<div class="outline-text-3" id="text-16-2">

<p>   要想使用cedet1.1和ecb2.4必须修改ecb2.4/ecb-upgrade.el中：<br/>
</p><ol>
<li>注释 ecb-check-requirements函数中：<br/>
</li>
</ol>




<pre class="src src-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">check if vedet-version is correct</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(when (or (not (boundp 'cedet-version))</span>
<span style="color: #b22222;">;;           </span><span style="color: #b22222;">(ecb-package-version-list&lt;</span>
<span style="color: #b22222;">;;            </span><span style="color: #b22222;">(ecb-package-version-str2list cedet-version)</span>
<span style="color: #b22222;">;;            </span><span style="color: #b22222;">ecb-required-cedet-version-min)</span>
<span style="color: #b22222;">;;           </span><span style="color: #b22222;">(ecb-package-version-list&lt;</span>
<span style="color: #b22222;">;;            </span><span style="color: #b22222;">ecb-required-cedet-version-max</span>
<span style="color: #b22222;">;;            </span><span style="color: #b22222;">(ecb-package-version-str2list cedet-version)))</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(setq version-error (concat "cedet ["</span>
<span style="color: #b22222;">;;                               </span><span style="color: #b22222;">cedet-required-version-str-min</span>
<span style="color: #b22222;">;;                               </span><span style="color: #b22222;">", "</span>
<span style="color: #b22222;">;;                               </span><span style="color: #b22222;">cedet-required-version-str-max</span>
<span style="color: #b22222;">;;                               </span><span style="color: #b22222;">"]")))</span>
</pre>

<ol>
<li>修改：<br/>
</li>
</ol>




<pre class="src src-lisp">(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">ecb-required-cedet-version-max</span> '(1 0 4 9))
&#20026;
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">ecb-required-cedet-version-max</span> '(1 1 4 9))
</pre>

<p>
   之后在ecb-2.4目录下 make CEDET=../cedet-1.1<br/>
</p></div>
</div>

</div>

<div id="outline-container-17" class="outline-2">
<h2 id="sec-17"><span class="section-number-2">17</span> dired-mode下批量修改文件名</h2>
<div class="outline-text-2" id="text-17">

<p>  C-x d打开一个目录后， <code>M-x wdired-change-to-wdired-mode</code> 进入可编辑模式，这样可以批量给文件改名。<br/>
  <link rel="stylesheet" href="../../Layout/CSS/jquery.lightbox-0.5.css" type="text/css" media="screen" /> <script type="text/javascript" src="../../Layout/JS/jquery.lightbox-0.5.js"></script> <center> <a class="lightbox" href="images/emacs-dired.png"> <img class="lightbox " title="点击查看大图" src="images/emacs-dired.png" width="400"> </a> </center> <script type="text/javascript"> $(function() {$('a.lightbox').lightBox();}); </script> 
</p></div>

</div>

<div id="outline-container-18" class="outline-2">
<h2 id="sec-18"><span class="section-number-2">18</span> Emacs中使用输入法</h2>
<div class="outline-text-2" id="text-18">

<p>  可以 <code>M-x customize-variable RET default-input-method</code> 来指定默认的输入法，例如 <code>chinese-pinyin</code> 。<br/>
  默认是 <code>C-\</code> 来调用。<br/>
  下面是五笔的配置，参考<a href="http://daiyuwen.freeshell.org/gb/wubi/wubi.html">http://daiyuwen.freeshell.org/gb/wubi/wubi.html</a><br/>
  这里设置的 <code>M-Space</code> 来调用。<br/>
</p>


<pre class="src src-lisp">(add-to-list 'load-path <span style="color: #8b2252;">"~/.emacs.d/wubi"</span>)
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">wubi</span>)
(wubi-load-local-phrases) <span style="color: #b22222;">; </span><span style="color: #b22222;">add user's Wubi phrases</span>
(register-input-method
 <span style="color: #8b2252;">"chinese-wubi"</span> <span style="color: #8b2252;">"Chinese-GB"</span> 'quail-use-package
 <span style="color: #8b2252;">"WuBi"</span> <span style="color: #8b2252;">"WuBi"</span>
 <span style="color: #8b2252;">"wubi"</span>)
(setq default-input-method <span style="color: #8b2252;">"chinese-wubi"</span>)
(global-set-key [?\M- ] 'toggle-input-method)
</pre>

<p>
  这样不管机器上有没有中文输入法，只要有Emacs就可以工作。<br/>
</p></div>

</div>

<div id="outline-container-19" class="outline-2">
<h2 id="sec-19"><span class="section-number-2">19</span> 乱码</h2>
<div class="outline-text-2" id="text-19">

<p>  可以 <code>C-x RET r TAB</code> 来选择编码。<br/>
  中文乱码可以在.emacs中加入以下代码：<br/>
</p>


<pre class="src src-lisp">(prefer-coding-system 'gb18030)
</pre>

<p>
  或：<br/>
</p>


<pre class="src src-lisp">(prefer-coding-system 'utf-8)
(prefer-coding-system 'chinese-gbk)
</pre>

</div>

</div>

<div id="outline-container-20" class="outline-2">
<h2 id="sec-20"><span class="section-number-2">20</span> Yasnippet共享</h2>
<div class="outline-text-2" id="text-20">

<p>  在c mode和c++ mode下都可以使用cc mode里面的yasnippet，其方法是在 snippet/c-mode和snippet/c++-mode目录下均存在.yas-parents其内容均为cc-mode。<br/>
这样便省去了重复定制yasnippet。<br/>
</p></div>

</div>

<div id="outline-container-21" class="outline-2">
<h2 id="sec-21"><span class="section-number-2">21</span> Yasnippet中使用elisp制定模板</h2>
<div class="outline-text-2" id="text-21">

<p>  yasnippet模板中``之间的elisp语句会被编译后替代原来代码，我每次写文章时打开一个org mode的新buffer时，首先要在文件头部包含一些相同的内容，例如：#+include "../../template.org" 其中../../template.org包含一些CSS控制文件，这些内容是固定不变的，所以直接写在yasnippet模板里就可以，但有些东西，例如标题，是与当前文件有关的，此时可以用elisp来实现动态插入标题：<br/>
</p><pre class="example">
# -*- mode: snippet -*-
# name: template
# --
#+OPTIONS: ^:{} _:{} num:t toc:t \n:t
#+include "../../template.org"
#+title:`(replace-regexp-in-string "\.org" "" (file-name-nondirectory (buffer-file-name (window-buffer (minibuffer-selected-window)))))`$0
</pre>

<p>  还可以写得更复杂一些，例如：我在文章最下面的查看Org源码button：<br/>
</p><pre class="example">
#+html:&lt;a class="btn btn-primary" href="`(funcall (lambda (filepath)
           (if (eq system-type 'gnu/linux)
               (if (string-match "Dropbox" filepath)
                   (replace-regexp-in-string "/home/visayafan/Dropbox/visayafan\.github\.com" "https://raw.github.com/visayafan/visayafan.github.com/master" filepath)
                 (replace-regexp-in-string "/home/visayafan/visayafan\.github\.com" "https://raw.github.com/visayafan/visayafan.github.com/master" filepath))
             (replace-regexp-in-string "D:/Dropbox/visayafan\.github\.com" "https://raw.github.com/visayafan/visayafan.github.com/master" filepath)
             ))
         (buffer-file-name (window-buffer (minibuffer-selected-window))))`"&gt;查看Org源码&lt;/a&gt;
</pre>

<p>  由于我在linux和windows下博客路径不同，所以其中有个判断语句；然后替换掉路径中的部分内容使其成为github上的链接。<br/>
</p></div>

</div>

<div id="outline-container-22" class="outline-2">
<h2 id="sec-22"><span class="section-number-2">22</span> eshell命令大小写不敏感</h2>
<div class="outline-text-2" id="text-22">

<p>  需要修改变量eshell-glob-case-insensitive为nil，可以用customize-variable来修改，也可以在配置文件中加上：<br/>
</p>


<pre class="src src-lisp">(custom-set-variables
 '(eshell-glob-case-insensitive nil)
)
  &#21478;&#22806;Win&#19979;&#22312;Eshell&#20013;&#36755;&#20837;&#30446;&#24405;&#22238;&#36710;&#33258;&#21160;cd&#12290;
</pre>

</div>

</div>

<div id="outline-container-23" class="outline-2">
<h2 id="sec-23"><span class="section-number-2">23</span> win7下find问题</h2>
<div class="outline-text-2" id="text-23">

<p>  尽管安装了GNUWin32但使用rgrep时仍然出问题，其实问题在于Win7自带的find命令，把system32下的find.exe改个名即可<br/>
</p></div>

</div>

<div id="outline-container-24" class="outline-2">
<h2 id="sec-24"><span class="section-number-2">24</span> CC-Mode</h2>
<div class="outline-text-2" id="text-24">

<p>  <a href="./CC-Mode.html">CC-Mode</a><br/>
</p></div>

</div>

<div id="outline-container-25" class="outline-2">
<h2 id="sec-25"><span class="section-number-2">25</span> Emacs Client启动后字体不正常和tabber不能使用解决办法</h2>
<div class="outline-text-2" id="text-25">




<pre class="src src-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35299;&#20915;emacs client&#23383;&#20307;&#38382;&#39064;</span>
(setq window-system-default-frame-alist
      '((x
         (font . <span style="color: #8b2252;">"-unknown-&#25991;&#27849;&#39551;&#31561;&#23485;&#24494;&#31859;&#40657;-normal-normal-normal-*-12-*-*-*-*-0-iso10646-1"</span>))
        (nil
         (font . <span style="color: #8b2252;">"-unknown-&#25991;&#27849;&#39551;&#31561;&#23485;&#24494;&#31859;&#40657;-normal-normal-normal-*-12-*-*-*-*-0-iso10646-1"</span>)
         (menu-bar-lines . 0) (tool-bar-lines . 0))))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">http://emacswiki.org/emacs/TabBarMode &#19978;&#25220;&#26469;&#30340;&#20195;&#30721;&#65292;&#35299;&#20915;emacsclient&#19979;tabber&#19981;&#33021;&#20351;&#29992;&#38382;&#39064;</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">Allow tab-bar-mode to be frame-local.  This is deprecated and exploits</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">the fact that `</span><span style="color: #008b8b;">default-header-line-format</span><span style="color: #b22222;">' is an alias of the global</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">value of `</span><span style="color: #008b8b;">header-line-format</span><span style="color: #b22222;">'. Tested with Emacs 24.1.</span>
(make-variable-frame-local 'default-header-line-format)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">These two are needed as the aliased frame-local value isn't recognized</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">unless the variable is explicitly accessed once. Do so on those two</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">occasions where this matters. Notably, `</span><span style="color: #008b8b;">handle-switch-frame</span><span style="color: #b22222;">' need not</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">be advised.</span>
(<span style="color: #a020f0;">defadvice</span> <span style="color: #0000ff;">select-frame</span> (after adapt-select-frame-parameters activate)
  <span style="color: #8b2252;">"Fix frame-local value of `</span><span style="color: #008b8b;">default-header-line-format</span><span style="color: #8b2252;">'."</span>
  (interactive)
  default-header-line-format)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">This absolutely must be after delete-frame, so</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">`</span><span style="color: #008b8b;">delete-frame-functions</span><span style="color: #b22222;">' won't work.</span>
(<span style="color: #a020f0;">defadvice</span> <span style="color: #0000ff;">delete-frame</span> (after adapt-delete-frame-parameters activate)
  <span style="color: #8b2252;">"Fix frame-local value of `</span><span style="color: #008b8b;">default-header-line-format</span><span style="color: #8b2252;">'."</span>
  (interactive)
  default-header-line-format)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Example usage: Set per-terminal (frame-local) options.</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">customize-terminal-frame</span> (frame)
  (<span style="color: #a020f0;">cond</span>
   ((frame-parameter frame 'window-system)
    (set-frame-parameter frame 'default-header-line-format '(<span style="color: #483d8b;">:eval</span> (tabbar-line)))
    (tabbar-init-tabsets-store))
   (t
    (set-frame-parameter frame 'default-header-line-format nil)
    (set-frame-parameter frame 'menu-bar-lines 0))))
(add-hook 'after-make-frame-functions 'customize-terminal-frame)
</pre>

</div>

</div>

<div id="outline-container-26" class="outline-2">
<h2 id="sec-26"><span class="section-number-2">26</span> Emacs Gnus 阅读新闻组</h2>
<div class="outline-text-2" id="text-26">

<p>  <a href="./EmacsGnus.html">配置+使用</a><br/>
</p></div>

</div>

<div id="outline-container-27" class="outline-2">
<h2 id="sec-27"><span class="section-number-2">27</span> Emacs Org-Mode 写文章做笔记</h2>
<div class="outline-text-2" id="text-27">

<p>  <a href="./EmacsOrg.html">配置+使用</a><br/>
</p></div>

</div>

<div id="outline-container-28" class="outline-2">
<h2 id="sec-28"><span class="section-number-2">28</span> Emacs 搜索总结</h2>
<div class="outline-text-2" id="text-28">

<ul>
<li>搜索内容都是小写字母，搜索时不区分大小写；搜索内容只要有一个大写字母，搜索时区分大小写<br/>
</li>
<li>C-s C-w：以光标后的一个单词(自动转为小写)做为搜索词立即开始搜索以下操作要在搜索开始后，才有效<br/>
</li>
<li>C-w(isearch-yank-word-or-char)：从buffer中取得char或word粘贴到搜索词之后<br/>
</li>
<li>C-y(isearch-yank-line)：从buffer中取得一行粘贴到搜索词之后<br/>
</li>
<li>C-s C-w：以光标后的一个单词(自动转为小写)做为搜索词立即开始搜索<br/>
</li>
<li>M-c(isearch-toggle-case-fold)：打开或关毕搜索大小写敏感<br/>
</li>
<li>M-e(isearch-edit-string)：光标跳到minibuffer，修改搜索词<br/>
</li>
<li>M-n(isearch-ring-advance)：搜索时循环查找后面的搜索词<br/>
</li>
<li>M-p(isearch-ring-retreat)：搜索时循环查找前面的搜索词<br/>
</li>
<li>M-r(isearch-toggle-regexp)：打开或关闭正则方式搜索<br/>
</li>
<li>M-s w(isearch-toggle-word)：以单词方式搜索<br/>
</li>
<li>M-y(isearch-yank-kill)：将kill ring中的内容放到搜索词中<br/>
</li>
<li>C-M-w 删除搜索词中最后一个字符<br/>
</li>
<li>C-M-y 将当前光标后一个字符复制到搜索词后<br/>
</li>
</ul>


</div>

</div>

<div id="outline-container-29" class="outline-2">
<h2 id="sec-29"><span class="section-number-2">29</span> Emacs Compile 出现乱码</h2>
<div class="outline-text-2" id="text-29">

<p>  编译的时候出现 <i>new.cc: In function â\200\230int main()â\200\231:</i> 之类。<br/>
  <a href="http://stackoverflow.com/questions/10374200/shell-in-emacs-displays-names-of-variables-by-preceding-them-200-230">解决办法</a><br/>
</p>


<pre class="src src-lisp">(setq default-process-coding-system '(utf-8-unix . utf-8-unix))
</pre>

</div>

</div>

<div id="outline-container-30" class="outline-2">
<h2 id="sec-30"><span class="section-number-2">30</span> Emacs M-x 目录操作</h2>
<div class="outline-text-2" id="text-30">

<p>  <code>copy-directory</code><br/>
  <code>delete-directory</code><br/>
  <code>make-directroy</code><br/>
  <code>list-directory</code><br/>
  操作可以在eshell下完成，不过对于不想离开当前buffer的情况下这直接运行上面命令的方式也是很高效的.<br/>
</p></div>

</div>

<div id="outline-container-31" class="outline-2">
<h2 id="sec-31"><span class="section-number-2">31</span> 查看当前buffer所有mode帮助信息</h2>
<div class="outline-text-2" id="text-31">

<p>  <code>C-h m</code><br/>
</p></div>

</div>

<div id="outline-container-32" class="outline-2">
<h2 id="sec-32"><span class="section-number-2">32</span> 利用CEDET生成UML</h2>
<div class="outline-text-2" id="text-32">

<p>  在C++文件中菜单 cedet-&gt;UML-&gt;autogenerate UML chart for class 输入类名则会生成相应的dot文件并调用graphviz来编译生成对应的图片。<br/>
  自动生成的图片感觉有些问题，可以安装 graphviz-dot-mode，在生成的dot文件上 C-c c编译 C-c p生成对应的图片。<br/>
</p></div>

</div>

<div id="outline-container-33" class="outline-2">
<h2 id="sec-33"><span class="section-number-2">33</span> 颜色</h2>
<div class="outline-text-2" id="text-33">

<p>  <code>M-x list-color-display</code> 查看颜色及对应的RGB值<br/>
</p></div>

</div>

<div id="outline-container-34" class="outline-2">
<h2 id="sec-34"><span class="section-number-2">34</span> find-name-dired</h2>
<div class="outline-text-2" id="text-34">

<p>  在指定目录下递归查找指定名文件。<br/>
</p></div>

</div>

<div id="outline-container-35" class="outline-2">
<h2 id="sec-35"><span class="section-number-2">35</span> ECB</h2>
<div class="outline-text-2" id="text-35">


</div>

<div id="outline-container-35-1" class="outline-3">
<h3 id="sec-35-1"><span class="section-number-3">35.1</span> 自定义ECB窗口宽度</h3>
<div class="outline-text-3" id="text-35-1">

<p>  设置 <code>ecb-windows-width</code> 变量。<br/>
</p>


<pre class="src src-lisp">(setq ecb-windows-width 0.25)
</pre>

</div>

</div>

<div id="outline-container-35-2" class="outline-3">
<h3 id="sec-35-2"><span class="section-number-3">35.2</span> 自定义ECB布局</h3>
<div class="outline-text-3" id="text-35-2">

<p>   ECB我最常用的窗口是method窗口，其它的像history/directories基本没用过.<br/>
   <code>M-x ecb-create-new-layout</code> 打开新的frame，按照提示创建新的只有method的布局。然后 <code>C-c . l c</code> 切换到新建的布局，此时只有method窗口，无法切换到其它窗口。<br/>
   （预定义布局中的left9实现同样的功能）<br/>
</p>
<p>
   如果想要打开ECB时就只显示method窗口，可以添加一个hook：<br/>
</p>


<pre class="src src-lisp">(add-hook 'ecb-activate-hook 'vf-show-method-window-only)
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">vf-show-method-window-only</span> ()
  (ecb-maximize-window-methods))
</pre>

</div>
</div>

</div>

<div id="outline-container-36" class="outline-2">
<h2 id="sec-36"><span class="section-number-2">36</span> 为新mode实现auto complete</h2>
<div class="outline-text-2" id="text-36">

<p>  <code>auto-complete</code> 维护一个变量 <code>ac-modes</code> 保存所有那些进入后应该自动打开 <code>auto-complete-mode</code> 的mode，所以应该先将在此变量中注册一下，以graphviz-dot-mode为例：<br/>
</p>


<pre class="src src-lisp">(add-to-list 'ac-modes 'graphviz-dot-mode)
</pre>

<p>
  <code>ac-sources</code> 是一个buffer-local变量，即每个buffer值都不一样，该变量中保存着此buffer中自动补全词汇来源，例如 <code>auto-complete-config.el</code> 中的一段代码：<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">ac-emacs-lisp-mode-setup</span> ()
  (setq ac-sources (append '(ac-source-features ac-source-functions ac-source-yasnippet ac-source-variables ac-source-symbols) ac-sources)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">ac-cc-mode-setup</span> ()
  (setq ac-sources (append '(ac-source-yasnippet ac-source-gtags) ac-sources)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">ac-ruby-mode-setup</span> ())

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">ac-css-mode-setup</span> ()
  (setq ac-sources (append '(ac-source-css-property) ac-sources)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">ac-config-default</span> ()
  (setq-default ac-sources '(ac-source-abbrev ac-source-dictionary ac-source-words-in-same-mode-buffers))
  (add-hook 'emacs-lisp-mode-hook 'ac-emacs-lisp-mode-setup)
  (add-hook 'c-mode-common-hook 'ac-cc-mode-setup)
  (add-hook 'ruby-mode-hook 'ac-ruby-mode-setup)
  (add-hook 'css-mode-hook 'ac-css-mode-setup)
  (add-hook 'auto-complete-mode-hook 'ac-common-setup)
  (global-auto-complete-mode t))
</pre>

<p>
  可见默认情况下lisp-mode的补全来源有 ac-source-features ac-source-functions ac-source-yasnippet ac-source-variables ac-source-symbols，由于写emacs lisp程序是经常需要补全emacs各个mode下的函数和变量所以ac-source-functions ac-source-variables被加入到ac-sources中，其它mode下一般用不到这两个来源，一般 <code>ac-source-yasnippet ac-source-dictionary ac-source-words-in-buffer</code> 即可满足要求。<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">graphviz-dot-mode-setup</span> ()
  (setq ac-sources '(
                     ac-source-yasnippet
                     ac-source-dictionary
                     ac-source-words-in-buffer)))
(add-hook 'graphviz-dot-mode-hook 'graphviz-dot-mode-setup)
</pre>

<p>
  字典保存目录：<br/>
</p>


<pre class="src src-lisp">(add-to-list 'ac-dictionary-directories <span style="color: #8b2252;">"~/.emacs.d/auto-complete/auto-complete/dict"</span>)
</pre>


<pre class="example">~ $ tree ~/.emacs.d/auto-complete/auto-complete/dict
/home/visayafan/.emacs.d/auto-complete/auto-complete/dict
|-- ada-mode
|-- haskell-mode
|-- java-mode
|-- graphviz-dot-mode
</pre>

<p>
  进入graphviz-dot-mode后自动选择由变量ac-dictionary-directories保存的目录下的graphviz-dot-mode文件，可以在此文件中加入自己想要补全的词汇，例如：<br/>
</p>


<pre class="example">graph
digraph
subgraph
node
edge
</pre>

<p>
  之后再打开dot后缀的文件后会自动进入auto-complete-mode。<br/>
</p></div>

</div>

<div id="outline-container-37" class="outline-2">
<h2 id="sec-37"><span class="section-number-2">37</span> sgml-pretty-print格式化html文件</h2>
<div class="outline-text-2" id="text-37">

<p>  用来处理杂乱的HTML代码。<br/>
  与indent-region不同的是它会在适当的地方加上换行符。如果代码模式没有问题只是缩进有问题可以用 <code>C-M-\</code> 。<br/>
</p></div>

</div>

<div id="outline-container-38" class="outline-2">
<h2 id="sec-38"><span class="section-number-2">38</span> HTML中输入特殊字符</h2>
<div class="outline-text-2" id="text-38">

<p>  HTML模式下， <code>C-c C-n</code> 再输入对应的字符即可。<br/>
</p></div>

</div>

<div id="outline-container-39" class="outline-2">
<h2 id="sec-39"><span class="section-number-2">39</span> cscope</h2>
<div class="outline-text-2" id="text-39">

<p>  <code>cscope -bR</code> 其中b表只build数据库，执行完后退出不显示Cscope GUI，R表递归；默认情况下只分析.c, .h, .y, or .l 后缀的文件。<br/>
  如果想要分析其它后缀的文件，例如.java，.cpp，就需要将要分析的文件名及路径放在cscope.files文件中（可以用find命令），然后再执行cscope -b。<br/>
</p>


<pre class="example">find . -name "*.[chSs]" -o -name "*.cpp" &gt;cscope.files
cscope -b
</pre>

<p>
  上面命令查找以c,h,s,S,cpp结尾的文件并保存到cscope.files中并生成相应数据库文件cscope.out.<br/>
</p>
<p>
  <b>note</b> 默认情况下cscope会索引工程中#include包含的文件(位于/usr/include下)以便定位系统函数；对于内核这样的工程，其#include包含的文件完全在自己的工程中，不需要使用/usr/include下的头文件，生成cscope.out时需要加上-k选项。<br/>
</p>
<p>
  <b>find技巧</b><br/>
</p><ol>
<li>正则查找 -regex.<br/>
     -name只支持globs，不是真正的regexp，上面的命令可以重写：<br/>



<pre class="example">find . -regex ".*\(c\|h\|s\|S\|cpp\)" &gt; cscope.files
</pre>

</li>
<li>如果想忽略查找文件下的某个文件可以用 -path PATH -prune -o<br/>



<pre class="example">find . -path "./document/*" -prune -o -name "*.c" -print &gt; cscope.files
</pre>

<p>
     上面命令会忽略当前目录下的document子目录<br/>
</p></li>
<li>忽略某子目录下除某个目录外的所有目录：<br/>



<pre class="example">find . -path "./document/*" ! -path "./document/man*" -prune -o -name "*.c" -print &gt; cscope.files
</pre>

<p>
     对于document目录只查看其下以man开头的目录。<br/>
     -path支持逻辑运算 AND OR !.<br/>
     对于上面的命令 "./document/man*" 包含在 "./document/*"中，用!即表示二者差集，不可以写成"./document"或"./document/man"<br/>
</p></li>
</ol>

</div>

</div>

<div id="outline-container-40" class="outline-2">
<h2 id="sec-40"><span class="section-number-2">40</span> 退出时session mode提示select-coding-system</h2>
<div class="outline-text-2" id="text-40">

<p>  session-mode是用来保存最近访问修改文件的非常有用的mode，有时由于输入了非正常字符会导致退出时由于无法正常识别于是提示select-coding-system等待用户输入字符集才能退出，解决办法是设置 <code>session-save-file-coding-system</code> 变量（此变量被session-save-file调用，设置default-coding-system没用）。<br/>
</p>


<pre class="example">(setq session-save-file-coding-system 'utf-8)
</pre>

</div>

</div>

<div id="outline-container-41" class="outline-2">
<h2 id="sec-41"><span class="section-number-2">41</span> Emacs下德语引号</h2>
<div class="outline-text-2" id="text-41">

<p>  至今没发现怎么打出德语中的第一个双引号 <code>„=，不过幸好有其它符号代替 =C-x 8 &lt;</code> and <code>C-x 8 &gt;</code> 。<br/>
</p></div>

</div>

<div id="outline-container-42" class="outline-2">
<h2 id="sec-42"><span class="section-number-2">42</span> 设置face</h2>
<div class="outline-text-2" id="text-42">

<p>  可以通过 <code>customize-faces</code> 来设置，比如想改变选中区域时区域的颜色，可以设置变量region，选择适当前景色或背景色，我在win下使用的颜色：<br/>
</p>


<pre class="src src-lisp">(custom-set-faces
 '(region ((t (<span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"yellow"</span> <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"blue"</span>)))))  
</pre>

<p>
  可以通过 <code>customize-themes</code> 来设置主题。<br/>
</p></div>

</div>

<div id="outline-container-43" class="outline-2">
<h2 id="sec-43"><span class="section-number-2">43</span> 添加环境变量</h2>
<div class="outline-text-2" id="text-43">

<p>  可以通过设置环境变量PATH和执行路径exec-path：<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">vf-add-to-exec-path</span> (path)
  <span style="color: #8b2252;">" &#21442;&#32771;&#65306;http://blog.csdn.net/winterttr/article/details/7273283"</span>
  (setenv <span style="color: #8b2252;">"PATH"</span> (concat (expand-file-name path)
                         path-separator
                         (getenv <span style="color: #8b2252;">"PATH"</span>)))
  (setq exec-path
        (cons (expand-file-name path)
              exec-path)))
(mapc #'vf-add-to-exec-path
      (reverse
       '(<span style="color: #8b2252;">"C:/Program Files/Git/bin"</span>
         <span style="color: #8b2252;">"D:/VFInstall/SBCL"</span>
         )))
</pre>

</div>

</div>

<div id="outline-container-44" class="outline-2">
<h2 id="sec-44"><span class="section-number-2">44</span> 编译指定目录下所有el文件为elc</h2>
<div class="outline-text-2" id="text-44">

<p>  可以加快启动速度<br/>
  在Emacs中 <code>C-u 0 M-x byte-compile-directory</code> <code>C-u 0</code> 表示不必每次都进行提示是否编译<br/>
  另一种方法将 <code>(byte-recompile-directory (expand-file-name "~/.emacs.d") 0)</code> 写入.emacs中每次启动emacs的时候都会进行编译那些elc日期比el文件早的文件。<br/>
  还有一种命令行方式<br/>
</p>


<pre class="src src-lisp">emacs --batch --eval '(byte-recompile-directory <span style="color: #8b2252;">"~/.emacs.d"</span>)'
</pre>

<p>
  可以为其定义别名，有时间的时候再编译重新编译。<br/>
</p></div>

</div>

<div id="outline-container-45" class="outline-2">
<h2 id="sec-45"><span class="section-number-2">45</span> 查看当前buffer所有mode</h2>
<div class="outline-text-2" id="text-45">

<p>  <code>describe-mode</code> or <code>C-h m</code><br/>
</p></div>

</div>

<div id="outline-container-46" class="outline-2">
<h2 id="sec-46"><span class="section-number-2">46</span> autoload</h2>
<div class="outline-text-2" id="text-46">

<p>  <a href="http://emacswiki.org/emacs/AutoLoad">http://emacswiki.org/emacs/AutoLoad</a><br/>
  <code>(autoload function file &amp;optional docstring interactive type)</code><br/>
  告诉Emacs function在file文件中。<br/>
  这个函数不会真正执行(可以用来加快Emacs启动速度的原因)，只是告诉Emacs这个函数的路径，当需要的时候Emacs知道加载哪个文件可以得到它。<br/>
  应用：<br/>
</p>


<pre class="src src-lisp">(autoload 'graphviz-dot-mode <span style="color: #8b2252;">"graphviz-dot-mode"</span> nil t)
(add-to-list 'auto-mode-alist '(<span style="color: #8b2252;">"\\.dot\\'"</span> . graphviz-dot-mode))
</pre>

<p>
  首先告诉Emacs graphviz-dot-mode函数在graphviz-dot-mode.el文件中（在load-path中寻找，可以通过如下语句向load-path添加目录 <code>(add-to-list 'load-path "~/.emacs.d/lisp/")</code> ）。<br/>
  <code>auto-mode-alist</code> 中的元素类似 <code>(REGEXP . FUNCTION)</code> 。<br/>
  之后告诉Emacs当打开dot后缀文件时执行函数graphviz-dot-mode，之后Emacs会加载文件graphviz-dot-mode以便得到该函数。<br/>
</p></div>

</div>

<div id="outline-container-47" class="outline-2">
<h2 id="sec-47"><span class="section-number-2">47</span> eval-after-load</h2>
<div class="outline-text-2" id="text-47">

<p>  <a href="http://emacser.com/eval-after-load.htm">http://emacser.com/eval-after-load.htm</a><br/>
  <code>(eval-after-load file form)</code><br/>
  当加载文件file的时候执行语句form。<br/>
  可以与autoload配合：<br/>
</p>


<pre class="example">(autoload 'A "B" nil t)
(add-to-list 'auto-mode-alist '("C" . A))
(eval-after-load B
      D)
</pre>

<p>
  <b>打开C后缀文件时调用A函数，为了得到A函数Emacs会加载B文件，加载B文件时会执行D代码。</b><br/>

</p>
<hr/>
<p>
  例如函数 <code>rgrep</code> 就是一个autoload类型的符号，可以通过： <code>(symbol-function 'rgrep)</code> 看到（执行该语句之前没有用过rgrep命令，否则会显示其定义）。<br/>
  在grep buffer里定义快捷键N向下翻页，P向上翻页，可以用 <code>define-key</code> 实现，但由于没有加载过grep.el所以grep-mode-map变量是未定义的，这时可以用eval-after-load:<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">eval-after-load</span> <span style="color: #8b2252;">"grep"</span>
  '(<span style="color: #a020f0;">progn</span>
     (<span style="color: #a020f0;">define-key</span> grep-mode-map <span style="color: #8b2252;">"N"</span> 'scroll-down)
     (<span style="color: #a020f0;">define-key</span> grep-mode-map <span style="color: #8b2252;">"P"</span> 'scroll-up)))
</pre>

<p>
  调用rgrep时会加载grep.el，又加载grep.el时会执行两条define-key语句，由于grep-mode-map是在grep.el加载后才被Emacs看到的，而这时变量已经定义了。<br/>
</p>
</div>

<div id="outline-container-47-1" class="outline-3">
<h3 id="sec-47-1"><span class="section-number-3">47.1</span> eval-after-load和mode hook的区别</h3>
<div class="outline-text-3" id="text-47-1">

<p>   <a href="http://stackoverflow.com/questions/2736087/eval-after-load-vs-mode-hook">http://stackoverflow.com/questions/2736087/eval-after-load-vs-mode-hook</a><br/>
   前者只会执行一次，对所有相同mode buffer适用。而mode hook只会对该mode的当前buffer适用。<br/>
   因此mode hook里的语句会迟于eval-after-load。<br/>
</p></div>
</div>

</div>

<div id="outline-container-48" class="outline-2">
<h2 id="sec-48"><span class="section-number-2">48</span> 查看.emacs中各语句执行时间</h2>
<div class="outline-text-2" id="text-48">

<p>  使用profile-dotemacs.el， =emacs -Q -l ~/.emacs.d/others/profile-dotemacs.el -f profile-dotemacs=，它会将.emacs文件中各语句执行时间的百分比显示出来（前提是.emac不能有错）。<br/>
  这对于排查哪个包占用时间最大非常有用。<br/>
</p></div>

</div>

<div id="outline-container-49" class="outline-2">
<h2 id="sec-49"><span class="section-number-2">49</span> electri-pair-mode</h2>
<div class="outline-text-2" id="text-49">

<p>  24版本中新的minor mode，相当于原来的auto-pair。<br/>
  该mode根据major mode选择闭合符合(例如在HTML中&lt;会自动闭合而其它mode中就不会)，可以配置 <code>electri-pair-pairs</code> 变量来使得在所有mode中指定括号问题自动闭合。<br/>
</p>


<pre class="src src-lisp">(setq electric-pair-pairs '(
                            (?\" . ?\")
                            (?\{ . ?\})
                            ))
</pre>


<p>  <br/>
</p>


<pre class="src src-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24320;&#21551;&#33258;&#21160;&#38381;&#21512;&#25324;&#21495;minor mode</span>
(electric-pair-mode 1)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20294;&#22312;lisp mode&#20013;&#20851;&#25481;&#23427;&#65292;&#22240;&#20026;&#20889;lisp&#20195;&#30721;&#26102;&#36825;&#20010;&#21151;&#33021;&#20250;&#25104;&#20026;&#38459;&#30861;</span>
(add-hook 'emacs-lisp-mode-hook
          '(<span style="color: #a020f0;">lambda</span> ()
             (set (make-local-variable 'electric-pair-mode) nil)))
</pre>

<p>
  通过 <code>(local-variable-p 'electric-pair-mode)</code> 可以看到 <code>electric-pair-mode</code> 并非一个local变量，所以直接 <code>(electric-pair-mode -1)</code> 的话会使其它buffer也关闭此minor mode，所以要先用 <code>make-local-variable</code> 将其变成local变量。<br/>
</p></div>
</div>
</div>

</body>
</html>
