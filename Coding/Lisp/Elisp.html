<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<title>Elisp笔记</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="Elisp笔记"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2012-12-14 09:05:07 CST"/>
<meta name="author" content="visayafan"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<div id="org-div-comments"><a href="../../index.html#lisp">主页</a></div>


</head>
<body>


<div id="content">
<h1 class="title">Elisp笔记</h1>


<!-- <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"> </script> -->
<link rel="stylesheet" type="text/css" href="../../Layout/CSS/bootstrap_old.css" />
<link rel="stylesheet" type="text/css" href="../../Layout/CSS/too_many_toc.css" />
<script src="../../Layout/JS/jquery_1.7.1.js"></script>
<script src="../../Layout/JS/bootstrap_old.js"></script>

<p>
Elisp Manual中查找函数快捷键为 <code>i</code> .<br/>
</p>


<pre class="example">sequence = list + array
array=vector+string+bool vector+char-table
</pre>

<p>
vector string number 是自我求值类型，即对其自身求值后仍为自身，用eq函数测试结果为真。<br/>
</p>
<div id="table-of-contents">
<h2>目录</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 字符串</a></li>
<li><a href="#sec-2">2 列表</a></li>
<li><a href="#sec-3">3 数组</a></li>
<li><a href="#sec-4">4 Ring</a></li>
<li><a href="#sec-5">5 符号</a></li>
<li><a href="#sec-6">6 文本属性</a>
<ul>
<li><a href="#sec-6-1">6.1 display用于文本替换</a></li>
</ul>
</li>
<li><a href="#sec-7">7 变量</a></li>
<li><a href="#sec-8">8 正则表达式</a></li>
<li><a href="#sec-9">9 缓冲区</a></li>
<li><a href="#sec-10">10 窗口</a></li>
<li><a href="#sec-11">11 文件</a></li>
<li><a href="#sec-12">12 函数</a>
<ul>
<li><a href="#sec-12-1">12.1 cond</a></li>
<li><a href="#sec-12-2">12.2 eql</a></li>
<li><a href="#sec-12-3">12.3 eval-when-compile</a></li>
<li><a href="#sec-12-4">12.4 eval-last-sexp</a></li>
<li><a href="#sec-12-5">12.5 copy-sequence</a></li>
<li><a href="#sec-12-6">12.6 dotimes</a></li>
<li><a href="#sec-12-7">12.7 lsh</a></li>
<li><a href="#sec-12-8">12.8 funcall</a></li>
<li><a href="#sec-12-9">12.9 apply</a></li>
<li><a href="#sec-12-10">12.10 defmacro</a></li>
<li><a href="#sec-12-11">12.11 defsubst</a></li>
<li><a href="#sec-12-12">12.12 loop</a></li>
</ul>
</li>
<li><a href="#sec-13">13 调试</a></li>
<li><a href="#sec-14">14 Tricks</a>
<ul>
<li><a href="#sec-14-1">14.1 用or来替代if not</a></li>
</ul>
</li>
<li><a href="#sec-15">15 分享/评论</a></li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 字符串</h2>
<div class="outline-text-2" id="text-1">




<pre class="src src-lisp">(stringp OBJECT)                               &#27979;&#35797;&#26159;&#21542;&#26159;&#23383;&#31526;&#20018;
(string-or-null-p OBJECT)                      &#19968;&#20010;&#23383;&#31526;&#25110;nil
(char-or-string-p OBJECT)                      &#23383;&#31526;&#20018;&#25110;&#19968;&#20010;&#23383;&#31526;
(make-string LENGTH INIT)                      LENGTH&#20010;ASCII&#20026;INIT&#30340;&#23383;&#31526;
(string <span style="color: #228b22;">&amp;rest</span> CHARACTERS)                      &#36830;&#25509;&#21442;&#25968;&#20013;&#25152;&#26377;&#23383;&#31526;
(substring STRING FROM <span style="color: #228b22;">&amp;optional</span> TO)           STRING&#20013;&#19979;&#26631;&#20174;FROM&#21040;TO&#20043;&#38388;&#30340;&#23383;&#31526;&#20018;&#65292;&#19979;&#26631;&#20174;0&#24320;&#22987;&#65292;&#24038;&#38381;&#21491;&#24320;
(char-equal C1 C2)                             &#23383;&#31526;&#27604;&#36739;&#65292;&#22914;&#26524;case-fold-search&#20026;t&#21017;&#24573;&#30053;&#22823;&#23567;&#20889;
(string= S1 S2) (string-equal S1 S2)           &#23383;&#31526;&#20018;&#21028;&#26029;&#26159;&#21542;&#30456;&#21516;
(string&lt; S1 S2) (string-less S1 S2)            &#23383;&#31526;&#20018;&#21028;&#26029;S1&#26159;&#21542;&#23567;&#20110;S2
(string-to-char STRING) (char-to-string CHAR)  &#23383;&#31526;&#20018;&#19982;&#23383;&#31526;&#36827;&#34892;&#36716;&#25442;
(number-to-string NUMBER)
(string-to-number STRING <span style="color: #228b22;">&amp;optional</span> BASE)       &#25968;&#23383;&#19982;&#23383;&#31526;&#20018;&#30340;&#36716;&#25442;
(format STRING <span style="color: #228b22;">&amp;rest</span> OBJECTS)                  &#23558;OBJECTS&#23545;&#35937;&#36716;&#25442;&#25104;STRING&#26684;&#24335;&#30340;&#23383;&#31526;&#20018;
(concat <span style="color: #228b22;">&amp;rest</span> SEQUENCES)                       &#23558;&#19968;&#20010;&#30001;&#23383;&#31526;&#26500;&#25104;&#30340;&#21015;&#34920;&#25110;&#21521;&#37327;&#36716;&#25442;&#25104;&#23383;&#31526;&#20018;
(vconcat <span style="color: #228b22;">&amp;rest</span> SEQUENCES)                      &#36830;&#25509;&#25152;&#26377;&#21442;&#25968;&#32452;&#25104;&#21521;&#37327;
(append <span style="color: #228b22;">&amp;rest</span> SEQUENCES)                       &#36830;&#25509;&#25152;&#26377;&#21442;&#25968;&#32452;&#25104;&#21015;&#34920;
(downcase OBJ) (upcase OBJ)                    &#22823;&#23567;&#20889;&#36716;&#25442;
(capitalize OBJ)                               &#23383;&#31526;&#20018;&#20013;&#27599;&#20010;&#21333;&#35789;&#31532;&#19968;&#20010;&#23383;&#31526;&#22823;&#20889;&#65292;&#20854;&#20313;&#23567;&#20889;
(upcase-initials OBJ)                          &#23383;&#31526;&#20018;&#20013;&#27599;&#20010;&#21333;&#35789;&#31532;&#19968;&#20010;&#23383;&#31526;&#22823;&#20889;&#65292;&#20854;&#20313;&#19981;&#21464;

(concat [?a ?b])
(concat '(?a ?b))
</pre>

<p>
   可以自定义判断字符串是否为空的函数：<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">string-empty-p</span> (str)
  (not (string&lt; <span style="color: #8b2252;">""</span> str)))
</pre>

</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> 列表</h2>
<div class="outline-text-2" id="text-2">

<p>  两个有序元素，第1个为CAR，第2个为CDR<br/>
  要用eval-last-sexp执行conscell则类似(1 . 2)必须写成'(1 . 2)或(quote(1 . 2))，eval-last-sexp其实包含了两个步骤,一是读一个S-表达式,是对读的S-表达式值。这样果读的S-表达式是一个conscell的话,值时会把这个conscell的第一个元素为一个函数来调用。事实,这例的第一个元素都不是一个函数,这样就会产生一个错误invalid-function。之所以有遇到这个问题,那是因为数和串是一类特殊的S-表达式,它值后和值是不变,称为值表达式(self-evaluatingform)’号其实是一个特殊的函数quote,它的用是将它的参数回不。值。’(1 . 2)等价于(quote(1 . 2))。<br/>
  (1 2 3) 是 (1 . (2 . (3 . nil))) 的缩写<br/>
  (1 2 . 3) 是 (1. (2 . 3)) 的缩写<br/>
</p>


<pre class="src src-lisp">(cadr X)                  == (car (cdr x))
(caar X)
(cddr X)
(consp OBJECT)            &#27979;&#35797;&#26159;&#21542;&#26159;cons cell&#31867;&#22411;
(listp OBJECT)            &#27979;&#35797;&#26159;&#21542;&#26159;&#21015;&#34920;&#65292;nil&#20063;&#26159;&#21015;&#34920;&#65292;&#38750;&#30495;&#21015;&#34920;
(null OBJECT)             &#24403;OBJECT&#26159;nil&#26102;&#36820;&#22238;&#30495;
(cons CAR CDR)            &#26500;&#36896;&#19968;&#20010;cons cell
(list <span style="color: #228b22;">&amp;rest</span> OBJECTS)      &#29983;&#25104;&#19968;&#20010;&#21015;&#34920;
(pop PLACE)
(push X PLACE)            &#22312;&#21015;&#34920;&#22836;&#37096;&#25554;&#20837;X&#65292;&#21407;&#22320;&#20462;&#25913;
(append <span style="color: #228b22;">&amp;rest</span> SEQUENCES)  &#25226;&#31532;&#19968;&#20010;&#21442;&#25968;&#26368;&#21518;&#19968;&#20010;&#21015;&#34920;&#30340;nil&#25442;&#25104;&#31532;&#20108;&#20010;&#21442;&#25968;&#65306;

(append '(a b) '(c))
</pre>

<p>
  '(a b)即(a . (b . nil))把nil换成 '(c) 即 (c . nil) 即结果为 (a . (b . (c . nil)))即(a b c)<br/>
</p>


<pre class="src src-lisp">(append '(a b) 'c)
</pre>

<p>
  同理把nil替换成第二个参数结果为(a . (b . c))缩写为(a b . c)<br/>
  不可以对(a b . c)进行append操作，因为最后一个列表中没有nil<br/>
  同理：<br/>
</p>


<pre class="src src-lisp">(append [a b] <span style="color: #8b2252;">"cd"</span>)                     <span style="color: #b22222;">;</span><span style="color: #b22222;">(a b . "cd")</span>
(append [a b] <span style="color: #8b2252;">"cd"</span> nil)                 <span style="color: #b22222;">;</span><span style="color: #b22222;">(a b c d)</span>
</pre>


<pre class="src src-lisp">(nth N LIST)            &#21015;&#34920;&#31532;N&#20010;&#20803;&#32032;
(nthcdr N LIST)         CDR&#20989;&#25968;&#25191;&#34892;N&#27425;&#65288;&#21363;&#19968;&#20010;&#21015;&#34920;&#20174;N&#20010;&#20803;&#32032;&#24320;&#22987;&#20043;&#21518;&#30340;&#20803;&#32032;&#65292;&#21253;&#25324;&#31532;N&#20010;&#20803;&#32032;&#65289;
(last LIST <span style="color: #228b22;">&amp;optional</span> N) &#36820;&#22238;&#21015;&#34920;&#26368;&#21518;N&#20010;&#20803;&#32032;&#65292;&#40664;&#35748;&#20026;&#26368;&#21518;&#19968;&#20010;&#20803;&#32032;
(butlast LIST <span style="color: #228b22;">&amp;optional</span> N) &#21015;&#34920;LIST&#21435;&#25481;&#26368;&#21518;N&#20010;&#20803;&#32032;&#21518;&#30340;&#21015;&#34920;
(length SEQUENCE)       &#36820;&#22238;&#19968;&#20010;&#24207;&#21015;&#30340;&#38271;&#24230;
(setcar CELL NEWCAR)
(setcdr CELL NEWCDR)    &#35774;&#32622;&#26032;&#30340;CAR&#65292;CDR
(setf PLACE VAL PLACE VAL ...) &#35774;&#32622;PLACE&#20026;VAL

(setf (car x) y) == (setcar x y)

(reverse LIST)          &#36870;&#36716;LIST&#65292;&#38750;&#21407;&#22320;
(nreverse LIST)         &#36870;&#36716;LIST&#65292;&#21407;&#22320;&#65288;&#23558;&#38142;&#34920;&#37324;&#25351;&#38024;&#36870;&#21516;&#65292;&#25152;&#20197;&#21407;&#26469;&#20195;&#34920;&#25972;&#20010;&#38142;&#34920;&#30340;&#25351;&#21521;&#22836;&#32467;&#28857;&#30340;&#25351;&#38024;&#25351;&#21521;&#26368;&#21518;&#19968;&#20010;&#32467;&#28857;&#65289;
(sort LIST PREDICATE)   &#25490;&#24207;&#65292;&#21407;&#22320;
(delete-dups LIST)      &#21024;&#38500;&#37325;&#22797;&#20803;&#32032;&#65292;&#21482;&#20445;&#30041;&#31532;&#19968;&#20010;&#36935;&#21040;&#30340;
</pre>

<p>
  eq与equal的区别：前者为真的情况有两个：1 数字或数字变量且值相同 2 对于字符串，列表，向量必须有相同的内容，即一个修改会反映到另一个上（有例外：(eq "" "")为真是因为elisp为了节省空间把所有的空串保存在同一空间）。后者则为普通的比较相同，不考虑其文本属性。<br/>
</p>


<pre class="src src-lisp">(delq ELT LIST)
(delete ELT SEQ)        &#21024;&#38500;&#19968;&#20010;&#20803;&#32032;&#65292;&#36820;&#22238;&#21024;&#38500;&#21518;&#30340;&#21015;&#34920;&#22797;&#26412;&#65292;&#26377;&#21487;&#33021;&#21407;&#22320;&#21024;&#38500;&#20063;&#26377;&#21487;&#33021;&#38750;&#21407;&#22320;&#65292;&#21069;&#32773;&#23545;&#23601;eq,&#21518;&#32773;&#23545;&#24212;equal
(remq ELT LIST)
(remove ELT SEQ)        &#38750;&#21407;&#22320;&#21024;&#38500;&#19968;&#20010;&#20803;&#32032;&#65292;&#36820;&#22238;&#21024;&#38500;&#21518;&#21015;&#34920;&#22797;&#26412;&#65292;&#21069;&#32773;&#23545;&#23601;eq,&#21518;&#32773;&#23545;&#24212;equal
(memq ELT LIST)
(member ELT LIST)       &#27979;&#35797;&#19968;&#20010;&#20803;&#32032;&#26159;&#21542;&#22312;&#21015;&#34920;&#20013;&#65292;&#21069;&#32773;&#23545;&#23601;eq,&#21518;&#32773;&#23545;&#24212;equal,&#22914;&#26524;&#23384;&#22312;&#36820;&#22238;&#20540;&#26159;&#20197;ELT&#20026;car&#30340;&#21015;&#34920;
</pre>

<p>
  用cons实现关联列表（association list），car对应key, cdr对应value,通过car取cdr:比较函数assp,assoc前者对应eq后者对应equal<br/>
</p>


<pre class="src src-lisp">(cdr (assoc <span style="color: #8b2252;">"a"</span> '((<span style="color: #8b2252;">"a"</span> 97) (<span style="color: #8b2252;">"b"</span> 98))))
&#20108;&#32773;&#31561;&#20215;
(assoc-default <span style="color: #8b2252;">"a"</span> '((<span style="color: #8b2252;">"a"</span> 97) (<span style="color: #8b2252;">"b"</span> 98)))
</pre>

<p>
  通过cdr取car: rassp,rassoc<br/>
</p>


<pre class="src src-lisp">(mapc FUNCTION SEQUENCE)
(mapcar FUNCTION SEQUENCE)      &#23558;FUNCTION&#24212;&#29992;&#22312;SEQUENCE&#27599;&#20010;&#20803;&#32032;&#19978;&#65292;&#21306;&#21035;&#22312;&#20110;&#65306;&#21069;&#32773;&#36820;&#22238;&#20462;&#25913;&#21069;&#21518;&#24207;&#21015;&#32780;&#21518;&#32773;&#36820;&#22238;&#20462;&#25913;&#21518;&#30340;&#24207;&#21015;&#65292;&#37117;&#26159;&#21407;&#22320;&#20462;&#25913;&#12290;
(<span style="color: #a020f0;">dolist</span> (VAR LIST [RESULT]) BODY...) &#36941;&#21382;&#21015;&#34920;&#65292;&#20854;&#20013;VAR&#20805;&#24403;&#20020;&#26102;&#21464;&#37327;&#35760;&#24405;&#27599;&#27425;&#36941;&#21382;&#26102;LIST&#23545;&#24212;&#30340;&#20803;&#32032;&#65292;&#22914;&#26524;RESULT&#20026;&#31354;&#21017;&#36820;&#22238;&#20540;&#20026;nil&#65292;&#21542;&#21017;&#36820;&#22238;&#20540;&#20026;RESULT

(<span style="color: #a020f0;">dolist</span> (var '(1 2 3))
  (1+ var)
  )                             <span style="color: #b22222;">;</span><span style="color: #b22222;">nil</span>
(setq result nil)
(<span style="color: #a020f0;">dolist</span> (var '(1 2 3) result)
  (push (1+ var) result)
  )                             <span style="color: #b22222;">;</span><span style="color: #b22222;">(4 3 2)</span>

(number-sequence FROM <span style="color: #228b22;">&amp;optional</span> TO INC) &#29992;&#26469;&#20135;&#29983;&#19968;&#20010;&#25968;&#21015;
(split-string STRING <span style="color: #228b22;">&amp;optional</span> SEPARATORS OMIT-NULLS) &#29992;SEPARATORS&#26469;&#20998;&#38548;STRING&#65292;&#40664;&#35748;&#20998;&#38548;&#31526;&#20026;split-string-default-separators&#65292;&#22914;&#26524;OMIT-NULL&#20026;t&#21017;&#32467;&#26524;&#20013;&#24573;&#30053;&#25481;&#31354;&#20018;,&#22914;&#26524;&#20998;&#38548;&#31526;&#20026;&#31354;&#20018;&#21017;&#20998;&#38548;STRISNG&#20013;&#27599;&#20010;&#23383;&#31526;&#65288;&#27492;&#26102;OMIT-NULLS&#19968;&#33324;&#20026;t&#65289;

(split-string <span style="color: #8b2252;">"Soup is good food"</span> <span style="color: #8b2252;">"o"</span>)
&#8658; (<span style="color: #8b2252;">"S"</span> <span style="color: #8b2252;">"up is g"</span> <span style="color: #8b2252;">""</span> <span style="color: #8b2252;">"d f"</span> <span style="color: #8b2252;">""</span> <span style="color: #8b2252;">"d"</span>)
(split-string <span style="color: #8b2252;">"Soup is good food"</span> <span style="color: #8b2252;">"o"</span> t)
&#8658; (<span style="color: #8b2252;">"S"</span> <span style="color: #8b2252;">"up is g"</span> <span style="color: #8b2252;">"d f"</span> <span style="color: #8b2252;">"d"</span>)

(mapconcat FUNCTION SEQUENCE SEPARATOR) &#23545;SEQUENCE&#20013;&#27599;&#20010;&#20803;&#32032;&#25191;&#34892;&#20989;&#25968;FUNCTION&#24182;&#20803;&#32032;&#20043;&#38388;&#29992;SEPERATOR&#36830;&#25509;&#36215;&#26469;&#65292;&#22914;&#26524;&#19981;&#38656;&#35201;&#23545;&#24207;&#21015;&#20013;&#30340;&#20803;&#32032;&#36827;&#34892;&#22788;&#29702;&#21487;&#20197;&#29992;&#20989;&#25968; identity
(identity ARG) &#25509;&#21463;&#21442;&#25968;ARG&#24182;&#19981;&#21464;&#22320;&#36820;&#22238;

(add-to-list LIST-VAR ELEMENT <span style="color: #228b22;">&amp;optional</span> APPEND COMPARE-FN)      &#22914;&#26524;&#21015;&#34920;LIST-VAR&#20013;&#19981;&#23384;&#22312;ELEMENT&#21017;&#21521;&#21015;&#34920;&#20013;&#28155;&#21152;&#20803;&#32032;ELEMENT&#65292;&#22914;&#26524;APPEND&#20026;&#31354;&#21017;&#28155;&#21152;&#21040;&#38142;&#39318;&#65292;&#21542;&#21017;&#28155;&#21152;&#21040;&#38142;&#23614;&#65307;&#22914;&#26524;COMPARE-FN&#20026;&#31354;&#21017;&#20351;&#29992;&#20989;&#25968;equal&#21542;&#21017;&#20351;&#29992;&#27604;&#36739;&#20989;&#25968;COMPARE-FN

</pre>

</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> 数组</h2>
<div class="outline-text-2" id="text-3">

<p>  数组创建时必须指定长度（char-table除外）<br/>
</p>


<pre class="src src-lisp">(elt SEQUENCE N)                &#24212;&#35813;&#26159;&#35856;&#38899;at&#65292;&#36820;&#22238;&#19968;&#20010;&#24207;&#21015;&#25351;&#23450;&#20301;&#32622;&#30340;&#20803;&#32032;
(aset ARRAY IDX NEWELT)         &#23558;&#25968;&#32452;&#19979;&#26631;&#32034;&#24341;&#20026;IDX&#30340;&#20803;&#32032;&#36171;&#26032;&#20540;
(aref ARRAY IDX)                &#35775;&#38382;&#25968;&#32452;
(fillarray ARRAY ITEM)          &#29992;ITEM&#22635;&#20805;&#25968;&#32452;
(vectorp OBJECT)                &#27979;&#35797;&#26159;&#21542;&#26159;&#21521;&#37327;
(vector <span style="color: #228b22;">&amp;rest</span> objects)          &#21019;&#24314;&#21521;&#37327;
(make-vector length object)     &#21019;&#24314;&#38271;&#24230;&#20026;length&#30340;&#21521;&#37327;&#65292;&#27599;&#20010;&#20803;&#32032;&#22343;&#20026;object
(vconcat <span style="color: #228b22;">&amp;rest</span> sequences)       &#23558;&#24207;&#21015;&#36716;&#21270;&#20026;&#21521;&#37327;
                                append&#21487;&#20197;&#25226;&#21521;&#37327;&#36716;&#21270;&#20026;&#21015;&#34920;&#65292;(append [1 2] nil) &#22240;&#20026;&#25968;&#32452;&#30340;&#22823;&#23567;&#26159;&#22266;&#23450;&#19981;&#21464;&#30340;&#35201;&#24819;&#22312;&#21521;&#37327;&#21518;&#38754;&#21152;&#19978;&#20803;&#32032;&#24517;&#39035;&#26159;&#21015;&#34920;&#65292;&#25152;&#20197;&#32467;&#26524;&#20026;&#21015;&#34920;&#31867;&#22411;&#30340;
</pre>

</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Ring</h2>
<div class="outline-text-2" id="text-4">

<p>  列表方便插入和删除，但索引非常耗时；数组索引非常快速但插入删除非常耗时（事实上elisp中不能对其进行插入删除操作）。<br/>
  而Ring则提供一种折中的方案，事先分配固定大小的空间，类似数组，但保持一个指针指向最新插入元素（我估计），所以可以插入删除，ring-insert如果空间不够用了则删除旧的以插入新的,ring-insert-at-beginning则插入到最前面将其做为最旧的元素，如果满的话则删除最新的元素。<br/>
</p>


<pre class="src src-lisp">make-ring size
ring-p obj
ring-size ring          &#36820;&#22238;&#20854;&#30495;&#23454;&#22823;&#23567;
ring-length ring        &#36820;&#22238;&#20854;&#23384;&#20648;&#20803;&#32032;&#20010;&#25968;
ring-element ring       &#23558;ring&#20013;&#20803;&#32032;&#32452;&#21512;&#24418;&#25104;&#21015;&#34920;&#24182;&#36820;&#22238;
ring-copy ring          &#36820;&#22238;ring&#30340;&#25335;&#36125;&#65292;&#19982;&#21407;ring&#20869;&#23481;&#23436;&#20840;&#30456;&#21516;&#65288;eq)
ring-empty-p
ring-ref ring index
ring-insert ring obj
ring-remove ring <span style="color: #228b22;">&amp;optional</span> index &#22914;&#26524;&#32034;&#24341;&#20026;&#31354;&#21017;&#21024;&#38500;&#26368;&#26087;&#30340;&#20803;&#32032;
ring-insert-at-beginning ring obj
</pre>

</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> 符号</h2>
<div class="outline-text-2" id="text-5">

<p>  默认保存符号的数组是个全局变量，名为obarray，但obarray也可以用来表示一种数据类型，其实是个向量。<br/>
  向obarray中添加符号用intern，如果不存在则添加，而intern-soft当符号不存在时则返回nil.<br/>
  符号=符号名+符号值+符号函数+属性列表<br/>
  属性列表对应的形式为(propname1 value1 propname2 value2 &hellip;)<br/>
</p>


<pre class="src src-lisp">(intern STRING <span style="color: #228b22;">&amp;optional</span> OBARRAY)       &#36820;&#22238;&#21517;&#20026;STRING&#30340;canonical&#31526;&#21495;&#22914;&#26524;&#27809;&#26377;&#21017;&#21019;&#24314;&#19968;&#20010;&#24182;&#36820;&#22238;&#65292;&#40664;&#35748;&#30340;OBARRAY&#26159;&#20840;&#23616;&#30340;obarray
(intern-soft NAME <span style="color: #228b22;">&amp;optional</span> OBARRAY)    &#22914;&#26524;&#27809;&#26377;&#21017;&#36820;&#22238;nil

(setq foo (make-vector 10 0))
(intern-soft <span style="color: #8b2252;">"abc"</span> foo)         <span style="color: #b22222;">;</span><span style="color: #b22222;">nil</span>
(intern <span style="color: #8b2252;">"abc"</span> foo)              <span style="color: #b22222;">;</span><span style="color: #b22222;">abc</span>
(intern-soft <span style="color: #8b2252;">"abc"</span> foo)         <span style="color: #b22222;">;</span><span style="color: #b22222;">abc</span>
(unintern <span style="color: #8b2252;">"abc"</span> foo)            <span style="color: #b22222;">;</span><span style="color: #b22222;">&#20174;foo&#36825;&#20010;obarray&#20013;&#21024;&#38500;"abc"&#36825;&#20010;&#31526;&#21495;</span>

(mapatoms FUNCTION <span style="color: #228b22;">&amp;optional</span> OBARRAY)   &#23545;OBARRAY&#19978;&#27599;&#20010;&#20803;&#32032;&#25191;&#34892;&#20989;&#25968;FUNCTION&#65292;&#20854;&#20013;OBARRAY&#40664;&#35748;&#26159;obarray
(set SYMBOL NEWVAL)                     &#35774;&#32622;&#31526;&#21495;&#20540;
(setq [SYM VAL]...)                     (setq sym val) =&gt; (set (quote sym) val)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#19979;&#38754;&#19977;&#20010;&#35821;&#21477;&#26159;&#31561;&#20215;&#30340;</span>
(setq foo 1)
(set 'foo 1)
(set (quote foo) 1)

(symbol-value SYMBOL)                   &#36820;&#22238;&#31526;&#21495;&#23545;&#24212;&#30340;&#20540;&#65292;&#20986;&#38169;&#21017;&#36820;&#22238;nil

(setq foo (make-vector 10 0))
(set (intern <span style="color: #8b2252;">"abc"</span> foo) <span style="color: #8b2252;">"cba"</span>)
(symbol-value (intern <span style="color: #8b2252;">"abc"</span> foo))

(boundp SYMBOL)                         &#27979;&#35797;&#31526;&#21495;&#20540;&#26159;&#21542;&#26377;&#35774;&#32622;
(fboundp SYMBOL)                        &#27979;&#35797;&#31526;&#21495;&#30340;&#31526;&#21495;&#20989;&#25968;&#26159;&#21542;&#26377;&#35774;&#32622;
(fset SYMBOL DEFINITION)                &#35774;&#32622;&#31526;&#21495;&#23545;&#24212;&#30340;&#31526;&#21495;&#20989;&#25968;&#20026;DEFINITION
(symbol-function SYMBOL)                &#36820;&#22238;&#31526;&#21495;&#30340;&#31526;&#21495;&#20989;&#25968;

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;obarray&#31867;&#22411;&#30340;foo&#20013;&#30340;&#31526;&#21495;"abc"&#23545;&#24212;&#30340;&#31526;&#21495;&#20989;&#25968;&#20026;&#20840;&#23616;obarray&#20013;&#31526;&#21495;car&#23545;&#24212;&#30340;&#31526;&#21495;&#20989;&#25968;</span>
(fset (intern <span style="color: #8b2252;">"abc"</span> foo) (symbol-function 'car))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35843;&#29992;foo&#20013;&#31526;&#21495;abc&#23545;&#24212;&#30340;&#31526;&#21495;&#20989;&#25968;&#65292;&#21442;&#25968;&#20026;&#19968;&#20010;cons cell</span>
(funcall (intern <span style="color: #8b2252;">"abc"</span> foo) '(a . b))

(put SYMBOL PROPNAME VALUE)             &#22312;&#31526;&#21495;SYMBOL&#30340;&#23646;&#24615;&#21015;&#34920;&#20013;&#28155;&#21152;&#23646;&#24615;&#21517;&#21450;&#20854;&#23646;&#24615;&#20540;
(get SYMBOL PROPNAME)                   &#24471;&#21040;&#31526;&#21495;SYMBOL&#23646;&#24615;&#21517;&#23545;&#24212;&#30340;&#23646;&#24615;&#20540;
(symbol-plist SYMBOL)                   &#36820;&#22238;&#31526;&#21495;SYMBOL&#23545;&#24212;&#30340;&#23646;&#24615;&#21015;&#34920;

(plist-get PLIST PROP)                  &#21462;&#24471;&#23646;&#24615;&#21015;&#34920;&#20013;&#23646;&#24615;&#21517;&#20026;PROP&#30340;&#20540;
(plist-put PLIST PROP VAL)              &#22914;&#26524;PROP&#24050;&#32463;&#23384;&#22312;&#20110;PLIST&#20013;&#21017;&#20462;&#25913;&#20854;&#20540;&#20026;VAL&#65292;&#22914;&#26524;&#19981;&#23384;&#22312;&#21017;&#28155;&#21152;&#65292;&#36820;&#22238;&#20540;&#20026;&#26032;&#30340;&#23646;&#24615;&#21015;&#34920;

</pre>

</div>

</div>

<div id="outline-container-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> 文本属性</h2>
<div class="outline-text-2" id="text-6">

<p>  buffer中的每个字符或字符串都有一个文本属性列表，列表中每个元素都有一个名字和值。<br/>
</p>
</div>

<div id="outline-container-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> display用于文本替换</h3>
<div class="outline-text-3" id="text-6-1">

<p>   下面函数用于把当前buffer前10个字符替换成一个A，因为前10个字符的display属性是相同的字符串对象。<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">foo</span> ()
  (<span style="color: #a020f0;">dotimes</span> (i 5)
    (<span style="color: #a020f0;">let</span> ((string <span style="color: #8b2252;">"A"</span>)
          (start (+ i i (point-min))))
      (put-text-property start (1+ start) 'display string)
      (put-text-property start (+ 2 start) 'display string))))
</pre>

<p>
   下面的函数由于concat创建新的字符串对象，所以每两个文本属性相同，所以前10个字符被替换成5个A：<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">foo</span> ()
  (<span style="color: #a020f0;">dotimes</span> (i 5)
    (<span style="color: #a020f0;">let</span> ((string (concat <span style="color: #8b2252;">"A"</span>))
          (start (+ i i (point-min))))
      (put-text-property start (1+ start) 'display string)
      (put-text-property start (+ 2 start) 'display string))))
</pre>

</div>
</div>

</div>

<div id="outline-container-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> 变量</h2>
<div class="outline-text-2" id="text-7">

<ol>
<li>每个变量代表一个符号，变量名即符号名，变量值即符号值，但变量不等同于符号，符号比变量多符号函数和属性列表。<br/>
</li>
<li>局部变量可以嵌套，为避免出现无限循环定义了最大嵌套深度：  max-specpdl-size.<br/>
</li>
<li>全局变量是所有buffer都可以访问到的，buffer局部变量是只有某个buffer可以访问到的，可以使用buffer局部变量来实现不同buffer之间的变量隔离。<br/>
</li>
<li>void与nil的区别：未定义的变量为void，一个变量为nil可以对此变量求值，而nil是个值，对void变量求值则会返回错误。<br/>
</li>
</ol>


<p>
  定义变量：<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">SYMBOL</span> <span style="color: #228b22;">&amp;optional</span> INITVALUE DOCSTRING)   &#23450;&#20041;SYMBOL&#20026;INITVALUE&#24182;&#36820;&#22238;SYMBOL&#65292;&#22914;&#26524;SYMBOL&#20026;void&#21017;&#35774;&#32622;SYMBOL&#20540;&#20026;INTIVALUE&#65307;&#22914;&#26524;&#26159;buffer-lcoal&#21464;&#37327;&#21017;&#35774;&#32622;&#20840;&#23616;&#21464;&#37327;&#20026;INTIVALUE&#32780;buffer-local&#21464;&#37327;&#19981;&#21464;&#65307;&#22914;&#26524;&#31526;&#21495;&#26377;&#23616;&#37096;&#32465;&#23450;&#21017;&#35774;&#32622;&#23616;&#37096;&#32465;&#23450;&#20540;
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">SYMBOL</span> INITVALUE [DOCSTRING])         &#21482;&#22788;const&#21482;&#26159;&#24314;&#35758;&#65292;&#22914;&#26524;&#20462;&#25913;&#19981;&#20250;&#25253;&#38169;&#12290;


</pre>


<pre class="src src-lisp">(make-local-variable VARIABLE)          &#20135;&#29983;&#19968;&#20010;&#24403;&#21069;buffer&#30340;&#23616;&#37096;&#21464;&#37327;&#65292;&#22914;&#26524;&#26377;&#20010;&#21516;&#21517;&#30340;&#20840;&#23616;&#21464;&#37327;&#21017;&#20854;&#21021;&#22987;&#20540;&#26159;&#20840;&#23616;&#21464;&#37327;&#65292;&#20854;&#20313;&#21508;&#20010;buffer&#20381;&#26087;&#20351;&#29992;&#20840;&#23616;&#21464;&#37327;
(kill-local-variable VARIABLE)
(kill-all-local-variables)              &#28040;&#38500;&#32531;&#20914;&#21306;&#20869;&#25152;&#26377;&#23616;&#37096;&#21464;&#37327;&#65292;&#20294;&#26377;&#23646;&#24615;permanent-local&#30340;&#19981;&#20250;&#34987;&#28040;&#38500;
(boundp SYMBOL)                         &#31526;&#21495;&#26159;&#21542;&#34987;&#32465;&#23450;
(default-boundp SYMBOL)                 &#31526;&#21495;&#26159;&#21542;&#26377;&#40664;&#35748;&#20540;
(makunbound SYMBOL)                     &#20351;SYMBOL&#20026;void(&#32780;&#38750;nil).&#22914;&#26524;&#26159;&#21160;&#24577;&#23616;&#37096;&#32465;&#23450;&#21017;&#21482;void&#24403;&#21069;&#30340;&#23616;&#37096;&#32465;&#23450;&#65292;&#20316;&#29992;&#33539;&#22260;&#21482;&#26159;&#24403;&#21069;&#30340;&#23616;&#37096;&#32465;&#23450;&#33539;&#22260;&#12290;
                                        11.4 When a Variable is <span style="color: #8b2252;">"Void"</span>
(make-variable-buffer-local VARIABLE)   &#20026;&#25152;&#26377;buffer&#20135;&#29983;&#19968;&#20010;&#21517;&#20026;VARIABLE&#30340;&#23616;&#37096;&#21464;&#37327;
(default-value SYMBOL)                  &#36820;&#22238;SYMBOL&#30340;&#20840;&#23616;&#21464;&#37327;
(buffer-local-value VARIABLE BUFFER)    &#36820;&#22238;BUFFER&#20013;&#21517;&#20026;VARIABLE&#30340;&#23616;&#37096;&#21464;&#37327;
(local-variable-p VARIABLE <span style="color: #228b22;">&amp;optional</span> BUFFER) &#22914;&#26524;&#22312;BUFFER&#20013;&#26377;&#20010;&#21517;&#20026;VARIABLE&#30340;&#23616;&#37096;&#21464;&#37327;&#21017;&#36820;&#22238;&#30495;
(get-buffer BUFFER-OR-NAME)             &#36820;&#22238;BUFFER-OR-NAME&#23545;&#24212;&#30340;BUFFER&#65292;&#22914;&#26524;&#27809;&#26377;&#21017;&#36820;&#22238;NIL
(<span style="color: #a020f0;">with-temp-buffer</span> <span style="color: #228b22;">&amp;rest</span> BODY)           &#21019;&#24314;&#19968;&#20010;&#20020;&#26102;buffer&#24182;&#19988;&#22312;&#27492;&#20020;&#26102;buffer&#20013;&#25191;&#34892;BODY
(<span style="color: #a020f0;">with-current-buffer</span> BUFFER-OR-NAME <span style="color: #228b22;">&amp;rest</span> BODY) &#25226;BUFFER-OR-NAME&#20316;&#20026;&#19968;&#20010;&#20020;&#26102;BUFFER&#25191;&#34892;BODY
</pre>

<p>
  下面的程序运行将出错，因为let局部绑定以出现顺序求值且使用的是绑定之前的值，此处x在let绑定前没有定义，而y需要的是绑定之前的值，所以出错。<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">let</span> ((x 2)
      (y x))
  (list x y))
</pre>

<p>
  而使用let*则不会出错，这是let与let*的区别。<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">let*</span> ((x 2)
      (y x))
  (list x y))
</pre>

</div>

</div>

<div id="outline-container-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> 正则表达式</h2>
<div class="outline-text-2" id="text-8">




<pre class="src src-lisp">(string-match REGEXP STRING <span style="color: #228b22;">&amp;optional</span> START)   &#23383;&#31526;&#20018;&#21305;&#37197;
(match-data <span style="color: #228b22;">&amp;optional</span> INTEGERS REUSE RESEAT)
(match-beginning SUBEXP)
(match-end SUBEXP)                             match-data&#36820;&#22238;&#20540;&#20013;&#31532;1&#65292;2&#20010;&#34920;&#21305;&#37197;&#21040;&#30340;&#20301;&#32622;&#65292;&#20043;&#21518;&#34920;&#31034;&#25429;&#25417;&#21040;&#30340;&#23383;&#31526;&#20018;&#30340;&#20301;&#32622;&#65292;&#20998;&#21035;&#23545;&#24212;&#19968;&#20010;match-beginning&#21644;match-end&#20013;&#30340;

(<span style="color: #a020f0;">progn</span>
  (string-match <span style="color: #8b2252;">"12</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">34</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">"</span> <span style="color: #8b2252;">"01234567"</span>)
  (match-data)                          <span style="color: #b22222;">;</span><span style="color: #b22222;">(1 5 3 5)</span>
  (match-beginning 0)                   <span style="color: #b22222;">;</span><span style="color: #b22222;">1</span>
  (match-beginning 1)                   <span style="color: #b22222;">;</span><span style="color: #b22222;">3</span>
  (match-end 0)                         <span style="color: #b22222;">;</span><span style="color: #b22222;">5</span>
  (match-end 1)                         <span style="color: #b22222;">;</span><span style="color: #b22222;">5</span>
)
(replace-match NEWTEXT <span style="color: #228b22;">&amp;optional</span> FIXEDCASE LITERAL STRING SUBEXP) &#21482;&#26367;&#25442;&#19968;&#20010;
(replace-regexp-in-string REGEXP REP STRING <span style="color: #228b22;">&amp;optional</span> FIXEDCASE LITERAL SUBEXP START) &#26367;&#25442;&#25152;&#26377;&#21305;&#37197;
(subst-char-in-string FROMCHAR TOCHAR STRING <span style="color: #228b22;">&amp;optional</span> INPLACE) &#23383;&#31526;&#26367;&#25442;
(princ OBJECT <span style="color: #228b22;">&amp;optional</span> PRINTCHARFUN) &#25171;&#21360;
(regexp-quote STRING) &#36820;&#22238;&#19968;&#20010;REGXP&#23383;&#31526;&#20018;&#20854;&#20869;&#23481;&#19982;STRING&#20869;&#23481;&#23436;&#20840;&#30456;&#21516;
(regexp-opt STRINGS <span style="color: #228b22;">&amp;optional</span> PAREN)    &#36820;&#22238;&#19968;&#20010;&#32463;&#36807;&#20248;&#21270;&#30340;&#27491;&#21017;&#34920;&#36798;&#24335;&#21305;&#37197;&#19968;&#20010;&#23383;&#31526;&#20018;&#21015;&#34920;&#37324;&#30340;&#25152;&#26377;&#23383;&#31526;&#20018;

(regexp-opt &#8217;(<span style="color: #8b2252;">"foobar"</span> <span style="color: #8b2252;">"foobaz"</span> <span style="color: #8b2252;">"foo"</span>)) <span style="color: #b22222;">; </span><span style="color: #b22222;">=&gt; "foo\\(?:ba[rz]\\)?"</span>

describe-syntax
describe-categories
</pre>

</div>

</div>

<div id="outline-container-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> 缓冲区</h2>
<div class="outline-text-2" id="text-9">

<p>  BUFFER名与文件名不一定一致。<br/>
</p>


<pre class="src src-lisp">(buffer-name <span style="color: #228b22;">&amp;optional</span> BUFFER)                  &#36820;&#22238;buffer&#30340;&#21517;&#23383;&#65292;&#40664;&#35748;&#26159;&#24403;&#21069;BUFFER
(rename-buffer NEWNAME <span style="color: #228b22;">&amp;optional</span> UNIQUE)        &#20026;buffer&#37325;&#21629;&#21517;&#12290;&#33509;UNIQUE&#20026;&#31354;&#65292;&#33509;NEWNAME&#24050;&#32463;&#23384;&#22312;&#21017;&#25253;&#38169;&#65307;&#33509;UNIQUTE&#19981;&#20026;&#31354;&#21017;&#29992;&#20989;&#25968;generate-new-buffer-name&#26469;&#29983;&#25104;BUFFER&#65292;&#21517;&#20026;&#65306;NEWNAME&lt;n&gt;&#20854;&#20013;n&#26159;&#20010;&#25968;&#23383;&#65292;&#34920;&#31034;&#31532;&#20960;&#20010;&#21517;&#20026;NEWNAME&#30340;BUFFER&#12290;
(current-buffer)                                &#36820;&#22238;&#24403;&#21069;&#32531;&#20914;&#21306;&#65292;&#24403;&#21069;&#32531;&#20914;&#21306;&#19981;&#19968;&#23450;&#26159;&#27491;&#22312;&#20351;&#29992;&#30340;&#32531;&#20914;&#21306;&#65292;&#21487;&#20197;&#29992;set-buffer&#26469;&#25351;&#23450;&#24403;&#21069;&#32531;&#20914;&#21306;
(set-buffer BUFFER-OR-NAME)                     &#35774;&#32622;&#24403;&#21069;&#32531;&#20914;&#21306;&#65292;&#21487;&#20197;&#29992;buffer&#25110;buffer&#30340;name&#20316;&#20026;&#21442;&#25968;
</pre>

<p>
  注意 set-buffer 执行完后如果之后没有执行语句则当前使用的buffer会自动变成当前缓冲区，所以要想改变缓冲区必须要set-buffer之后紧接着执行语句：<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">progn</span>
  (set-buffer <span style="color: #8b2252;">"*Messages*"</span>)
  (message (buffer-name)))              <span style="color: #b22222;">;</span><span style="color: #b22222;">*Message*</span>

(set-buffer <span style="color: #8b2252;">"*Messages*"</span>)
(message (buffer-name))                 <span style="color: #b22222;">;</span><span style="color: #b22222;">tmp.el</span>
</pre>

<p>
  先把之前的缓冲区保存起来，最后再恢复。<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">let</span> ((old-buffer (current-buffer)))
  (set-buffer buffername)
  ...
  (set-buffer old-buffer))
</pre>

<p>
  或使用函数 <code>save-current-buffer</code><br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">save-current-buffer</span> <span style="color: #228b22;">&amp;rest</span> BODY)        &#25191;&#34892;&#23436;BODY&#21518;&#24674;&#22797;&#32531;&#20914;&#21306;&#12290;&#22914;&#26524;&#21407;&#26469;&#30340;&#32531;&#20914;&#21306;&#20851;&#38381;&#20102;&#65292;&#21017;&#20351;&#29992;BODY&#20013;&#20351;&#29992;&#30340;&#26368;&#21518;&#19968;&#20010;&#32531;&#20914;&#21306;&#20316;&#20026;&#24403;&#21069;&#32531;&#20914;&#21306;&#12290;
</pre>

<p>
  或 <code>with-current-buffer</code><br/>
  lisp 中很多以 with 开头的宏,这 宏通常是在不改变当态下,临时用另一个变量代替现有变量执语句.<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">with-current-buffer</span> BUFFER-OR-NAME <span style="color: #228b22;">&amp;rest</span> BODY)         &#20197;BUFFER-OR-NAME&#20316;&#20026;&#24403;&#21069;&#32531;&#20914;&#21306;&#25191;&#34892;BODY&#20013;&#30340;&#35821;&#21477;
</pre>

<p>
  或 <code>save-excursion</code><br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">save-excursion</span> <span style="color: #228b22;">&amp;rest</span> BODY)     &#19981;&#20165;&#20445;&#23384;&#24403;&#21069;&#32531;&#20914;&#21306;&#65292;&#36824;&#20445;&#23384;&#20301;&#32622;&#21644;mark
</pre>



<pre class="src src-lisp">(get-buffer BUFFER-OR-NAME)             &#36820;&#22238;&#25351;&#23450;&#30340;BUFFER&#65292;&#22914;&#26524;&#19981;&#23384;&#22312;&#21017;&#36820;&#22238;nil
(get-buffer-create BUFFER-OR-NAME)      &#22914;&#26524;&#19981;&#23384;&#22312;&#23601;&#21019;&#24314;&#19968;&#20010;
(generate-new-buffer NAME)              &#20135;&#29983;&#19968;&#20010;&#26032;BUFFER&#65292;&#22914;&#26524;NAME&#24050;&#32463;&#23384;&#22312;&#21017;&#20351;&#29992; generate-new-buffer-name
(kill-buffer <span style="color: #228b22;">&amp;optional</span> BUFFER-OR-NAME)  &#32570;&#30465;&#24403;&#21069;BUFFER
(buffer-live-p OBJECT)                  &#22914;&#26524;OBJECT&#26159;&#20010;BUFFER&#19988;&#26410;&#34987;KILL&#21017;&#36820;&#22238;&#30495;
(buffer-list <span style="color: #228b22;">&amp;optional</span> FRAME)           &#32570;&#30465;&#36820;&#22238;&#25152;&#26377;&#23384;&#22312;&#30340;BUFFER&#65292;&#33509;&#25351;&#23450;frame&#21017;&#36820;&#22238;&#25351;&#23450;frame&#19978;&#30340;BUFFER&#21015;&#34920;
(<span style="color: #a020f0;">with-temp-buffer</span> <span style="color: #228b22;">&amp;rest</span> BODY)           &#21019;&#24314;&#19968;&#20010;&#20020;&#26102;&#32531;&#20914;&#21306;&#24182;&#22312;&#27492;&#32531;&#20914;&#21306;&#20013;&#25191;&#34892;BODY
(make-marker)                           &#21019;&#24314;&#19968;&#20010;&#26032;&#30340;&#26631;&#35760;&#65292;&#19981;&#25351;&#21521;&#20219;&#20309;&#22320;&#26041;
(set-marker MARKER POSITION <span style="color: #228b22;">&amp;optional</span> BUFFER) &#35774;&#32622;&#19968;&#20010;&#26631;&#35760;&#30340;&#20301;&#32622;&#65292;&#40664;&#35748;&#26159;&#24403;&#21069;&#32531;&#20914;&#21306;
(point-marker)                          &#36820;&#22238;&#24403;&#21069;&#28857;&#30340;marker
(copy-marker <span style="color: #228b22;">&amp;optional</span> MARKER TYPE)     &#22797;&#21046;&#26631;&#35760;&#25110;&#32773;&#22914;&#26524;&#21442;&#25968;&#26159;&#25968;&#23383;&#30340;&#35805;&#36820;&#22238;&#35813;&#20301;&#32622;&#30340;&#19968;&#20010;marker
(marker-position MARKER)                &#36820;&#22238;&#19968;&#20010;&#26631;&#35760;&#30340;&#20301;&#32622;
(marker-buffer MARKER)                  &#36820;&#22238;&#19968;&#20010;&#26631;&#35760;&#25152;&#22312;&#30340;&#32531;&#20914;&#21306;
(point)                                 &#36820;&#22238;&#24403;&#21069;&#20301;&#32622;
(point-min)
(point-max)
(buffer-size <span style="color: #228b22;">&amp;optional</span> BUFFER)          &#40664;&#35748;&#36820;&#22238;&#24403;&#21069;&#32531;&#20914;&#21306;&#30340;&#23383;&#31526;&#20010;&#25968;&#65292;&#19968;&#33324; (point-max)=(buffer-size)+1
(push-mark <span style="color: #228b22;">&amp;optional</span> LOCATION NOMSG ACTIVATE)
(pop-mark)                              &#21521;mark-ring&#20013;&#21387;&#20837;&#25110;&#24377;&#20986;&#19968;&#20010;mark
(region-beginning)                      &#36820;&#22238;point&#21644;mark&#20013;&#36739;&#23567;&#20540;
(region-end)                            &#36739;&#22823;&#20540;&#65292;&#29992;C-x C-x&#29983;&#25104;&#30340;&#21306;&#22495;
(goto-char POSITION)
(forward-char <span style="color: #228b22;">&amp;optional</span> N)
(backward-char <span style="color: #228b22;">&amp;optional</span> N)
(forward-word <span style="color: #228b22;">&amp;optional</span> ARG)
(backward-word <span style="color: #228b22;">&amp;optional</span> ARG)
(forward-line <span style="color: #228b22;">&amp;optional</span> N)              &#21521;&#21069;N&#34892;&#65292;&#20301;&#32622;&#22312;&#34892;&#39318;(forward-line 0)&#31227;&#21160;&#21040;&#34892;&#39318;
(backward-line <span style="color: #228b22;">&amp;optional</span> N)
(line-beginning-position <span style="color: #228b22;">&amp;optional</span> N)   &#40664;&#35748;&#24403;&#21069;&#34892;&#34892;&#39318;&#20301;&#32622;&#65292;N&#20026;&#27491;&#21017;&#21069;N&#34892;&#34892;&#39318;&#20301;&#32622;&#65292;N&#20026;&#36127;&#21017;&#21518;
(line-end-position <span style="color: #228b22;">&amp;optional</span> N)         &#34892;&#23614;&#20301;&#32622;
(line-number-at-pos <span style="color: #228b22;">&amp;optional</span> POS)      &#40664;&#35748;&#24403;&#21069;&#20301;&#32622;&#34892;&#21495;&#65292;&#25110;&#25351;&#23450;&#20301;&#32622;&#34892;&#21495;
(bobp)                                  &#27979;&#35797;&#20301;&#32622;&#26159;&#21542;&#22312;beginning of buffer
(eobp)
(bolp)                                  beginning of line predicate
(eolp)
(buffer-string)                         &#20197;strng&#24418;&#24335;&#36820;&#22238;&#24403;&#21069;&#32531;&#20914;&#21306;&#30340;&#20869;&#23481;
(buffer-substring START END)
(char-after)
(char-before)
(current-word)
(thing-at-point THING)                  THING&#26159;&#20010;&#35821;&#27861;&#21333;&#20803;
(insert <span style="color: #228b22;">&amp;rest</span> ARGS)                     &#24403;&#21069;&#20301;&#32622;&#21518;&#25554;&#20837;ARGS&#65292;&#23383;&#31526;&#20018;&#25110;&#23383;&#31526;
(insert-char CHARACTER COUNT <span style="color: #228b22;">&amp;optional</span> INHERIT) &#25554;&#20837;CHARACTER COUNT&#27425;
(insert-buffer-substring BUFFER <span style="color: #228b22;">&amp;optional</span> START END)
(insert-buffer BUFFER)
(delete-char N <span style="color: #228b22;">&amp;optional</span> KILLFLAG)      &#21024;&#38500;&#21518;N&#20010;&#65292;&#21069;N&#20010;&#23383;&#31526;&#65288;N&#20026;&#36127;&#65289;&#65292;&#22914;&#26524;KILLFALG&#21017;&#20445;&#23384;&#22312;kill ring&#20013;
(delete-backward-char N <span style="color: #228b22;">&amp;optional</span> KILLFLAG)  &#19982;&#19978;&#30456;&#21453;
(delete-region START END)
(delete-and-extract-region START END)   &#19982;&#19978;&#21306;&#21035;&#22312;&#20110;&#36820;&#22238;&#21024;&#38500;&#30340;&#21306;&#22495;&#20869;&#23481;
(re-search-forward REGEXP <span style="color: #228b22;">&amp;optional</span> BOUND NOERROR COUNT)        &#21521;&#21069;&#26597;&#25214;&#65292;&#21487;&#34892;&#21442;&#25968;BOUND&#34920;&#31034;&#19981;&#36229;&#36807;&#36825;&#20010;&#20301;&#32622;&#65292;NOERROR&#22914;&#26524;&#26597;&#25214;&#22833;&#36133;&#30340;&#35805;&#65292;&#36820;&#22238;nil&#65292;&#19981;&#26159;&#38169;&#35823;&#65307;COUNT&#26597;&#25214;&#21040;&#30340;&#31532;COUNT&#20010;&#12290;
(re-search-backward REGEXP <span style="color: #228b22;">&amp;optional</span> BOUND NOERROR COUNT)
(replace-match NEWTEXT <span style="color: #228b22;">&amp;optional</span> FIXEDCASE LITERAL STRING SUBEXP)       &#23558;&#19978;&#27425;&#26597;&#25214;&#21040;&#30340;&#20869;&#23481;&#26367;&#25442;&#25104;NEWTEXT
(<span style="color: #a020f0;">save-restriction</span> <span style="color: #228b22;">&amp;rest</span> BODY)           C-x n n =&gt;narrow to region C-x n w =&gt; widen &#22312;narrow-to-region&#21518;&#30340;&#32467;&#26524;&#19978;&#25191;&#34892;BODY&#65292;&#20043;&#21518;&#20877;widen&#65292;&#21363;&#20316;&#29992;BODY&#22312;&#25351;&#23450;region&#19978;
(subst-char-in-region START END FROMCHAR TOCHAR <span style="color: #228b22;">&amp;optional</span> NOUNDO) &#22312;START&#21040;END&#20043;&#38388;&#23558;FROMECHAR&#36716;&#25442;&#25104;TOCHAR
(buffer-substring START END)            &#36820;&#22238;&#24403;&#21069;buffer&#20013;&#25351;&#23450;&#20301;&#32622;&#30340;&#20869;&#23481;
</pre>

</div>

</div>

<div id="outline-container-10" class="outline-2">
<h2 id="sec-10"><span class="section-number-2">10</span> 窗口</h2>
<div class="outline-text-2" id="text-10">

<p>  C-x 2 or C-x 3分割的是窗口，C-x 5 2创建的是Frame.<br/>
</p>


<pre class="src src-lisp">(split-window <span style="color: #228b22;">&amp;optional</span> WINDOW SIZE SIDE)       &#20998;&#21106;&#25351;&#23450;&#31383;&#21475;&#65292;&#40664;&#35748;&#26159;&#24403;&#21069;&#31383;&#21475;&#65292;SIZE&#25351;&#23450;&#22823;&#23567;&#65292;&#40664;&#35748;&#26159;&#24179;&#20998;&#65292;SIDE&#25351;&#23450;&#27700;&#24179;&#36824;&#26159;&#22402;&#30452;&#20998;&#21106;&#65292;&#40664;&#35748;&#26159;&#27700;&#24179;&#12290;&#36820;&#22238;&#20540;&#26159;&#26032;&#21019;&#24314;&#30340;&#31383;&#21475;&#65292;&#20809;&#26631;&#20173;&#26087;&#20572;&#30041;&#22312;&#21407;&#26469;&#31383;&#21475;&#19978;&#12290;
(selected-window)                               &#36820;&#22238;&#20809;&#26631;&#25152;&#22312;&#30340;&#31383;&#21475;
(delete-window <span style="color: #228b22;">&amp;optional</span> WINDOW)                C-x 0
(windowp OBJECT)
(window-live-p OBJECT)
(current-window-configuration <span style="color: #228b22;">&amp;optional</span> FRAME)  &#20445;&#23384;&#25351;&#23450;Frame&#30340;&#31383;&#21475;&#37197;&#32622;&#65292;&#40664;&#35748;&#26159;&#24403;&#21069;Frame
(set-window-configuration CONFIGURATION)
(other-window COUNT <span style="color: #228b22;">&amp;optional</span> ALL-FRAMES)       &#36339;&#36716;&#21040;&#20854;&#23427;&#31383;&#21475;&#65292;COUNT&#36339;&#36716;&#27425;&#25968;
(<span style="color: #a020f0;">save-selected-window</span> <span style="color: #228b22;">&amp;rest</span> BODY)               &#25191;&#34892;&#35821;&#21477;&#32467;&#26463;&#21518;&#36873;&#25321;&#25191;&#34892;&#20043;&#21069;&#30340;&#31383;&#21475;&#65292;&#22914;&#26524;&#37027;&#20010;&#31383;&#21475;&#19981;&#23384;&#22312;&#20102;&#65292;&#21017;&#36873;&#25321;BODY&#37324;&#26368;&#21518;&#36873;&#25321;&#30340;&#37027;&#20010;&#31383;&#21475;
(<span style="color: #a020f0;">with-selected-window</span> WINDOW <span style="color: #228b22;">&amp;rest</span> BODY)        &#22312;&#25351;&#23450;&#30340;&#31383;&#21475;&#25191;&#34892;BODY&#65292;&#20043;&#21518;&#24674;&#22797;&#21040;&#25191;&#34892;&#21069;&#30340;&#31383;&#21475;
(next-window <span style="color: #228b22;">&amp;optional</span> WINDOW MINIBUF ALL-FRAMES)       &#25351;&#23450;WINDOW&#30340;&#19979;&#19968;&#20010;&#31383;&#21475;&#65292;&#40664;&#35748;&#24403;&#21069;&#31383;&#21475;&#19979;&#19968;&#20010;&#65307;MINIBUF&#20026;t&#34920;&#31034;&#32771;&#34385;minibuffer&#65307;ALL-FRAMES&#20026;t&#34920;&#31034;&#25152;&#26377;frame
(previous-window <span style="color: #228b22;">&amp;optional</span> WINDOW MINIBUF ALL-FRAMES)
(window-list <span style="color: #228b22;">&amp;optional</span> FRAME MINIBUF WINDOW)    &#25351;&#23450;FRAME&#19978;&#20174;&#25351;&#23450;WINDOW&#24320;&#22987;&#30340;windows&#21015;&#34920;&#65292;MINIBUF&#20026;t&#34920;&#31034;&#21253;&#21547;minibuffer&#65292;&#40664;&#35748;&#24403;&#21069;FRAME
&#24403;&#21069;&#31383;&#21475;&#24320;&#22987;
(get-window-with-predicate PREDICATE <span style="color: #228b22;">&amp;optional</span> MINIBUF ALL-FRAMES DEFAULT)      &#36820;&#22238;&#28385;&#36275;&#26576;&#20010;PREDICATE&#26465;&#20214;&#30340;WINDOW&#65292;MINIBUF&#20026;t&#34920;&#21253;&#21547;minbuffer&#65292;&#20026;nil&#34920;&#31034;&#21482;&#26377;minibuffer&#27963;&#21160;&#26102;&#25165;&#21253;&#21547;&#23427;&#65307; ALL-FRAME&#20026;t&#34920;&#25152;&#26377;FRAME&#65292;visible&#34920;&#25152;&#26377;&#21487;&#35270;frame&#30340;&#25152;&#26377;&#31383;&#21475;&#65292;&#19968;&#20010;&#25351;&#23450;frame&#34920;&#22312;&#25351;&#23450;&#19978;&#25152;&#26377;&#31383;&#21475;&#65307; DEFAULT&#20026;&#34920;&#26597;&#25214;&#22833;&#36133;&#21518;&#40664;&#35748;&#31383;&#21475;&#12290;
(window-height)                                 
(window-body-height)                            &#19981;&#21253;&#25324;header-line&#21644;mode-line&#65292;&#20197;&#34892;&#20026;&#21333;&#20301;
(window-width)
(window-edges)                                  &#24038;&#19978;&#35282;&#21491;&#19979;&#35282;&#22352;&#26631;
(window-inside-edges)                           &#25991;&#26412;&#21306;&#22495;&#22352;&#26631;
(window-pixel-edges)                            &#20197;&#20687;&#32032;&#20026;&#21333;&#20301;
(window-inside-pixel-edges)

(window-buffer <span style="color: #228b22;">&amp;optional</span> WINDOW)                &#25351;&#23450;&#31383;&#21475;&#19978;&#30340;buffer&#65292;&#40664;&#35748;&#24403;&#21069;&#31383;&#21475;
(get-buffer-window <span style="color: #228b22;">&amp;optional</span> BUFFER-OR-NAME ALL-FRAMES) &#25351;&#23450;BUFFER&#23545;&#24212;&#30340;&#31383;&#21475;&#65292;&#40664;&#35748;&#24403;&#21069;buffer
(get-buffer-window-list <span style="color: #228b22;">&amp;optional</span> BUFFER-OR-NAME MINIBUF ALL-FRAMES)
(set-window-buffer WINDOW BUFFER-OR-NAME <span style="color: #228b22;">&amp;optional</span> KEEP-MARGINS)        &#35774;&#32622;&#25351;&#23450;&#31383;&#21475;WINDOW&#26174;&#31034;&#30340;&#21517;&#20026;FRAME-OR-NAME&#30340;buffer&#65292;WINDOW&#20026;nil&#34920;&#24403;&#21069;&#31383;&#21475;&#12290;
(switch-to-buffer BUFFER-OR-NAME <span style="color: #228b22;">&amp;optional</span> NORECORD FORCE-SAME-WINDOW)  &#40664;&#35748;C-x b
(window-start <span style="color: #228b22;">&amp;optional</span> WINDOW)                 &#25351;&#23450;&#31383;&#21475;&#26174;&#31034;&#24320;&#22987;&#30340;&#20301;&#32622;&#65288;&#24038;&#19978;&#35282;&#20301;&#32622;&#65289;
(set-window-start WINDOW POS <span style="color: #228b22;">&amp;optional</span> NOFORCE) &#35774;&#32622;&#25351;&#23450;&#31383;&#21475;&#30340;&#24320;&#22987;&#20301;&#32622;
(pos-visible-in-window-p <span style="color: #228b22;">&amp;optional</span> POS WINDOW PARTIALLY)        &#25351;&#23450;&#31383;&#21475;&#30340;&#25351;&#23450;&#20301;&#32622;&#26159;&#21542;&#21487;&#35265;&#65292;&#40664;&#35748;&#26159;&#24403;&#21069;&#31383;&#21475;&#30340;&#24403;&#21069;&#20301;&#32622;&#12290;&#22914;&#26524;POS&#21487;&#35265;&#19988;PARTIALLY&#20026;nil&#21017;&#36820;&#22238;t&#65292;&#22914;&#26524;PARTIALLY&#20026;non-nil&#26159;&#36820;&#22238;&#19968;&#20010;&#21015;&#34920;&#65306;(X Y [RTOP RBOT ROWH VPOS])&#65292;X&#65292;Y&#34920;&#31034;&#20687;&#32032;&#22352;&#26631;
</pre>

</div>

</div>

<div id="outline-container-11" class="outline-2">
<h2 id="sec-11"><span class="section-number-2">11</span> 文件</h2>
<div class="outline-text-2" id="text-11">




<pre class="src src-lisp">(find-file FILENAME <span style="color: #228b22;">&amp;optional</span> WILDCARDS)        &#25171;&#24320;&#25991;&#20214;&#24182;&#36716;&#21040;&#20854;&#23545;&#24212;&#30340;&#32531;&#20914;&#21306;&#65292;&#22914;&#26524;WILDCARDS&#38750;&#31354;&#21017;&#23637;&#24320;WILDCARDS&#20197;&#35775;&#38382;&#22810;&#20010;&#25991;&#20214;&#65292;&#36820;&#22238;&#23545;&#24212;&#30340;buffer
(find-file-noselect FILENAME <span style="color: #228b22;">&amp;optional</span> NOWARN RAWFILE WILDCARDS)        &#19982;&#19978;&#20010;&#20989;&#25968;&#19981;&#21516;&#65306;&#24182;&#19981;&#36716;&#21040;&#30456;&#24212;&#30340;buffer
(buffer-file-name <span style="color: #228b22;">&amp;optional</span> BUFFER)             &#36820;&#22238;&#25351;&#23450;buffer&#23545;&#24212;&#30340;&#25991;&#20214;&#21517;
(set-visited-file-name FILENAME <span style="color: #228b22;">&amp;optional</span> NO-QUERY ALONG-WITH-FILE)     &#35774;&#32622;&#19982;&#24403;&#21069;buffer&#20851;&#32852;&#30340;&#25991;&#20214;&#65292;&#24182;&#37325;&#21629;&#21517;&#24403;&#21069;buffer&#20026;&#25991;&#20214;&#21517;&#65292;&#33509;FILENAME&#20026;&#31354;&#21017;&#21462;&#28040;&#24403;&#21069;buffer&#30340;&#20851;&#32852;&#25991;&#20214;&#65292;NO-QUERY&#20026;nil&#34920;&#19981;&#38656;&#35201;&#35810;&#38382;
(get-file-buffer FILENAME)                      &#36820;&#22238;&#19982;&#25351;&#23450;&#25991;&#20214;&#30456;&#20851;&#32852;&#30340;buffer
(find-buffer-visiting FILENAME <span style="color: #228b22;">&amp;optional</span> PREDICATE)
(save-buffer <span style="color: #228b22;">&amp;optional</span> ARGS)                    C-x C-s
(write-file FILENAME <span style="color: #228b22;">&amp;optional</span> CONFIRM)         C-x C-w
(insert-file-contents FILENAME <span style="color: #228b22;">&amp;optional</span> VISIT BEG END REPLACE) C-x i &#36820;&#22238;&#20540;&#26159;&#25991;&#20214;&#21517;&#30340;&#32477;&#23545;&#36335;&#24452;&#21644;&#25554;&#20837;&#23383;&#31526;&#20010;&#25968;&#32452;&#25104;&#30340;&#21015;&#34920;&#12290;REPLACE&#20026;&#38750;&#31354;&#34920;&#26367;&#25442;&#24403;&#21069;&#32531;&#20914;&#21306;&#20869;&#23481;
(write-region START END FILENAME <span style="color: #228b22;">&amp;optional</span> APPEND VISIT LOCKNAME MUSTBENEW)     &#25226;&#24403;&#21069;&#32531;&#20914;&#21306;&#37096;&#20998;&#25554;&#20837;&#21040;FILENAME&#20013;&#65292;&#22914;&#26524;START&#20026;nil&#21017;&#34920;&#31034;&#25972;&#20010;&#32531;&#20914;&#21306;&#20869;&#23481;&#65292;&#22914;&#26524;START&#26159;&#23383;&#31526;&#20018;&#21017;&#34920;&#31034;&#23558;&#27492;&#23383;&#31526;&#20018;&#20889;&#21040;&#25991;&#20214;&#20013;&#65292;&#27492;&#26102;END&#34987;&#24573;&#30053;&#12290;APPEND&#38750;&#31354;&#34920;&#36861;&#21152;&#21040;&#25991;&#20214;&#23614;&#65292;&#22914;&#26524;&#26159;&#25972;&#25968;&#34920;&#31034;&#25554;&#20837;&#21040;&#25351;&#23450;&#30340;&#20559;&#31227;&#20301;&#32622;&#65292;&#20250;&#35206;&#30422;&#20043;&#21518;&#30340;&#20869;&#23481;&#12290;
(file-readable-p FILENAME)
(file-writable-p FILENAME)
(file-executable-p FILENAME)
(file-exists-p FILENAME)
(file-modes FILENAME)
(file-regular-p FILENAME)
(file-directory-p FILENAME)
(file-symlink-p FILENAME)               &#22914;&#26524;&#26159;&#31526;&#21495;&#38142;&#25509;&#30340;&#35805;&#36820;&#22238;&#20540;&#26159;&#27492;&#31526;&#21495;&#38142;&#25509;&#25152;&#38142;&#25509;&#30340;&#25991;&#20214;&#21517;
(file-truename FILENAME)                &#25991;&#20214;&#30340;&#30495;&#23454;&#21517;&#65292;&#22914;&#26524;&#30456;&#23545;&#25991;&#20214;&#21017;&#23637;&#24320;&#25104;&#32477;&#23545;&#36335;&#24452;&#65292;&#22914;&#26524;&#26159;&#38142;&#25509;&#25991;&#20214;&#21017;&#36319;&#36394;&#38142;&#25509;&#30452;&#21040;&#27809;&#26377;&#38142;&#25509;&#20026;&#27490;&#12290;
(file-attributes FILENAME <span style="color: #228b22;">&amp;optional</span> ID-FORMAT)  &#25991;&#20214;&#23646;&#24615;

(rename-file FILE NEWNAME <span style="color: #228b22;">&amp;optional</span> OK-IF-ALREADY-EXISTS)
(delete-file FILENAME <span style="color: #228b22;">&amp;optional</span> TRASH)
(copy-file FILE NEWNAME <span style="color: #228b22;">&amp;optional</span> OK-IF-ALREADY-EXISTS KEEP-TIME PRESERVE-UID-GID PRESERVE-SELINUX-CONTEXT)
(delete-directory DIRECTORY <span style="color: #228b22;">&amp;optional</span> RECURSIVE TRASH)
(set-file-times FILENAME <span style="color: #228b22;">&amp;optional</span> TIMESTAMP)
(set-file-modes FILENAME MODE)

(file-name-directory FILENAME)
(file-name-nondirectory FILENAME)
(file-name-extension FILENAME)
(file-name-sans-extension FILENAME)     &#25991;&#20214;&#21517;&#21435;&#25481;&#25193;&#23637;&#21517;

(file-name-absolute-p FILENAME)
(expand-file-name NAME <span style="color: #228b22;">&amp;optional</span> DEFAULT-DIRECTORY)     &#25193;&#23637;&#25104;&#32477;&#23545;&#36335;&#24452;&#65292;&#22914;&#26524;DEFAULT-DIRECTORY&#38750;&#31354;&#34920;&#25193;&#23637;&#25104; DEFAULT-DIRECTORY/NAME
(file-relative-name FILENAME <span style="color: #228b22;">&amp;optional</span> DIRECTORY)       &#36716;&#25442;&#25104;&#30456;&#23545;&#36335;&#24452;&#65292;DIRECTORY&#38750;&#31354;&#34920;&#31034;FILENAME&#30456;&#23545;DIRECTORY&#30340;&#30456;&#23545;&#36335;&#24452;
(file-name-as-directory FILE)                           &#36820;&#22238;&#32467;&#26524;FILE&#30446;&#24405;&#24418;&#24335;&#65288;&#20351;&#29992; (concat dir <span style="color: #8b2252;">"/"</span>)&#20250;&#26377;&#31227;&#26893;&#38382;&#39064;&#65289;
(directory-file-name DIRECTORY)                         &#19982;&#19978;&#20010;&#20989;&#25968;&#30456;&#21453;

(file-name-as-directory <span style="color: #8b2252;">"~rms/lewis"</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">=&gt; "~rms/lewis/"</span>
(directory-file-name <span style="color: #8b2252;">"~lewis/"</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">=&gt; "~lewis"</span>

(convert-standard-filename FILENAME)                    &#36716;&#21270;&#20026;&#19982;OS&#30456;&#21305;&#37197;&#30340;&#25991;&#20214;&#21517;&#26684;&#24335;
(make-temp-file PREFIX <span style="color: #228b22;">&amp;optional</span> DIR-FLAG SUFFIX)
(directory-files DIRECTORY <span style="color: #228b22;">&amp;optional</span> FULL MATCH NOSORT) &#36820;&#22238;&#30446;&#24405;&#19979;&#25152;&#26377;&#25991;&#20214;&#21517;&#26500;&#25104;&#30340;&#21015;&#34920;&#65292;&#33509;FULL&#20026;&#38750;nil&#21017;&#32477;&#23545;&#21517;&#65292;&#21542;&#21017;&#30456;&#23545;&#21517;&#65292;&#40664;&#35748;&#26159;&#30456;&#23545;&#21517;&#12290;MATCH&#38750;nil&#34920;&#21482;&#21015;&#20986;&#21305;&#37197;&#25991;&#20214;&#21517;&#65307;NOSORT&#38750;nil&#34920;&#27809;&#26377;&#25490;&#24207;&#65292;&#24207;&#21015;&#19981;&#21487;&#30693;&#12290;
(directory-files-and-attributes DIRECTORY <span style="color: #228b22;">&amp;optional</span> FULL MATCH NOSORT ID-FORMAT) &#21015;&#34920;&#20013;&#21253;&#21547;&#25991;&#20214;&#23646;&#24615;
</pre>

</div>

</div>

<div id="outline-container-12" class="outline-2">
<h2 id="sec-12"><span class="section-number-2">12</span> 函数</h2>
<div class="outline-text-2" id="text-12">

<p>  宏与函数的区别在于：宏把参数原封不动地传递给之后的BODY，而函数是将参数求值后的结果传递给BODY。<br/>
</p>
</div>

<div id="outline-container-12-1" class="outline-3">
<h3 id="sec-12-1"><span class="section-number-3">12.1</span> cond</h3>
<div class="outline-text-3" id="text-12-1">

<p>   (cond CLAUSES) 尝试每个语句直到成功<br/>
   CLAUSES是一组类似 (CONDITION body) 的语句，CONDITION判断真假，如果为真则body被执行<br/>
</p></div>

</div>

<div id="outline-container-12-2" class="outline-3">
<h3 id="sec-12-2"><span class="section-number-3">12.2</span> eql</h3>
<div class="outline-text-3" id="text-12-2">

<p>   不仅测试值是否相同还测试类型是否一致，=只测试值是否相同<br/>
</p></div>

</div>

<div id="outline-container-12-3" class="outline-3">
<h3 id="sec-12-3"><span class="section-number-3">12.3</span> eval-when-compile</h3>
<div class="outline-text-3" id="text-12-3">




<pre class="src src-lisp"><span style="color: #b22222;">; </span><span style="color: #b22222;">&#24403;&#32534;&#35793;&#30340;&#26102;&#20505;&#21152;&#36733;common lisp&#24211;</span>
(<span style="color: #a020f0;">eval-when-compile</span>
        (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">cl</span>))
</pre>

</div>

</div>

<div id="outline-container-12-4" class="outline-3">
<h3 id="sec-12-4"><span class="section-number-3">12.4</span> eval-last-sexp</h3>
<div class="outline-text-3" id="text-12-4">

<p>   执行当前点前的语句在minubuffer中输出结果，绑定C-x C-e<br/>
</p></div>

</div>

<div id="outline-container-12-5" class="outline-3">
<h3 id="sec-12-5"><span class="section-number-3">12.5</span> copy-sequence</h3>
<div class="outline-text-3" id="text-12-5">

<p>   (copy-sequence ARG)     返回ARG的一个拷贝<br/>
   新序列与原序列共享元素，一个修改对另一个修改是可见的。<br/>
   如果元素是有文本属性的字符串，则属性列表并不共享而是新的列表，但属性的值是共享的。<br/>
   此函数对循环列表不适用否则会引起无限循环<br/>
</p></div>

</div>

<div id="outline-container-12-6" class="outline-3">
<h3 id="sec-12-6"><span class="section-number-3">12.6</span> dotimes</h3>
<div class="outline-text-3" id="text-12-6">

<p>   (dotimes (VAR COUNT [RESULT]) BODY&hellip;)       循环COUNT次，其中VAR存放计数器，COUNT为循环次数，如果RESULT为空则返回为NIL，否则返回RESULT。其中VAR从0开始一直到COUNT-1。<br/>
</p></div>

</div>

<div id="outline-container-12-7" class="outline-3">
<h3 id="sec-12-7"><span class="section-number-3">12.7</span> lsh</h3>
<div class="outline-text-3" id="text-12-7">

<p>   (lsh VALUE COUNT)    如果COUNT为正整数则将VALUE左移COUNT位，如果COUNT为负则右移同时高位补充0<br/>
</p></div>

</div>

<div id="outline-container-12-8" class="outline-3">
<h3 id="sec-12-8"><span class="section-number-3">12.8</span> funcall</h3>
<div class="outline-text-3" id="text-12-8">

<p>   (funcall FUNCTION &amp;rest ARGUMENTS) 函数调用，其中 FUNCTION为函数，其余为函数参数，返回执行结果<br/>
</p></div>

</div>

<div id="outline-container-12-9" class="outline-3">
<h3 id="sec-12-9"><span class="section-number-3">12.9</span> apply</h3>
<div class="outline-text-3" id="text-12-9">

<p>   (apply FUNCTION &amp;rest ARGUMENTS) 应用函数其参数为剩下的参数返回值是函数的返回值<br/>
   appy与funcall的区别在于：apply最后一个参数是列表，把列表展开后结果作为参数传递给函数，而funcall则是把参数原封不动地传递给函数。<br/>
</p></div>

</div>

<div id="outline-container-12-10" class="outline-3">
<h3 id="sec-12-10"><span class="section-number-3">12.10</span> defmacro</h3>
<div class="outline-text-3" id="text-12-10">

<p>   (defmacro NAME ARGLIST [DOCSTRING] [DECL] BODY&hellip;) 定义一个宏，调用时先展开宏。<br/>
</p></div>

</div>

<div id="outline-container-12-11" class="outline-3">
<h3 id="sec-12-11"><span class="section-number-3">12.11</span> defsubst</h3>
<div class="outline-text-3" id="text-12-11">

<p>   (defsubst NAME ARGLIST &amp;rest BODY) 定义一个内联函数<br/>
</p></div>

</div>

<div id="outline-container-12-12" class="outline-3">
<h3 id="sec-12-12"><span class="section-number-3">12.12</span> loop</h3>
<div class="outline-text-3" id="text-12-12">

<p>   loop是CL中的函数使用前需要(require 'cl).<br/>
</p>


<pre class="src src-lisp">(<span style="color: #a020f0;">loop</span> for buf in (buffer-list) collect (buffer-file-name buf))

`for VAR from EXPR1 to EXPR2 by EXPR3'

(<span style="color: #a020f0;">loop</span> for x to 10 by 2 collect x)       &#40664;&#35748;&#26159;0&#24320;&#22987;&#65292;&#40664;&#35748;&#38388;&#38548;&#26159;1
&#27492;&#22788;&#24182;&#19981;&#26159;&#23884;&#22871;&#30340;for&#65292;&#19982;&#20854;&#23427;&#32534;&#31243;&#35821;&#35328;&#30340;&#21306;&#21035;
(<span style="color: #a020f0;">loop</span> for x from 1 to 100
      for y = (* x x)
      until (&gt;= y 729)
      finally return (list x (= y 729)))

`for VAR in LIST by FUNCTION'
(<span style="color: #a020f0;">loop</span> for x in '(1 2 3) collect x)                      &#40664;&#35748;&#20989;&#25968;&#26159;cdr
(<span style="color: #a020f0;">loop</span> for x in '(1 2 3 4 5 6) by 'cddr collect x)

`for VAR on LIST by FUNCTION'
(<span style="color: #a020f0;">loop</span> for x on '(1 2 3) collect x)              &#22312;LIST&#19978;&#36845;&#20195;&#25152;&#26377;&#30340;cons cell

`for VAR in-ref LIST by FUNCTION'
&#19982;in&#30340;&#21306;&#21035;&#22312;&#20110;&#27492;&#22788;&#21487;&#20197;&#20462;&#25913;LIST

`for VAR across ARRAY'
&#36845;&#20195;VAR&#20110;ARRAY&#20013;&#25152;&#26377;&#20803;&#32032;&#65292;&#20854;&#20013;ARRAY&#21487;&#20197;&#26159;&#23383;&#31526;&#20018;&#25110;&#21521;&#37327;

`for VAR across-ref ARRAY'
&#21487;&#20197;&#20462;&#25913;

`repeat INTEGER'
(<span style="color: #a020f0;">loop</span> repeat 20 do (insert <span style="color: #8b2252;">"\ndo"</span>))

`while CONDITION'
(<span style="color: #a020f0;">let</span> ((i 0))
  (<span style="color: #a020f0;">loop</span> while (&lt; i 10) do (incf i) (message <span style="color: #8b2252;">"%d"</span> i)))

`until CONDITION'
`always CONDITION'              &#22914;&#26524;CONDITION&#20026;nil&#21017;&#20572;&#27490;&#24490;&#29615;

`collect FORM'
&#25910;&#38598;&#25351;&#23450;&#20803;&#32032;&#26500;&#25104;&#21015;&#34920;

`append FORM'
&#21033;&#29992;append&#20989;&#25968;&#23558;&#26500;&#25104;&#21015;&#34920;

`nconc FORM'
&#21407;&#22320;&#20462;&#25913;&#24335;&#22320;&#25910;&#38598;

`concat FORM'           &#26500;&#25104;&#21015;&#34920;
`vconcat FORM'          &#26500;&#25104;&#21521;&#37327;

(<span style="color: #a020f0;">loop</span> for name in '(fred sue alice joe june)
      for kids in '((bob ken) () () (kris sunshine) ())
      collect name
      append kids)
        =&gt; (fred bob ken sue alice joe kris sunshine june)
</pre>

</div>
</div>

</div>

<div id="outline-container-13" class="outline-2">
<h2 id="sec-13"><span class="section-number-2">13</span> 调试</h2>
<div class="outline-text-2" id="text-13">

<p>  使用Edebug调试。在欲调试的函数上 C-u C-M-x （带前缀的 eval-defun，称为instrumenting）,之后调用函数执行即可进入调试模式，此时会在执行行前显示黑色箭头。<br/>
  每个快捷键对应一个模式<br/>
</p><ol>
<li>SPC会在下一次停止点上停止执行。edebug-step-mode<br/>
</li>
<li>n next表达式之后下一个停止点。edebug-next-mode<br/>
</li>
<li>g go运行直到断点. edebug-go-mode<br/>
</li>
<li>t trace跟踪，自动执行，在每个停止点都暂停1秒,时间由 edebug-sit-for-seconds来确定。edebug-trace-mode<br/>
</li>
<li>T Rapid trace，与上面区别在于暂停时间几乎为0。edebug-trace-fast-mode<br/>
</li>
<li>c continue. 在每个断点暂停1秒后继续。edebug-continue-mode<br/>
</li>
<li>C Rapid continue. 与上区别在于暂停时间几乎为0。edebug-continue-fast-mode<br/>
</li>
<li>G Go non-stop.忽略断点，可以用S来停止程序。edebug-go-nonstop-mode<br/>
</li>
<li>S stop. edebug-stop<br/>
</li>
</ol>

<p>  跳转：<br/>
</p><ol>
<li>h 停止在光标所在附近。edebug-goto-here<br/>
</li>
<li>f forward执行一个表达式,可以加前缀N来前进N个表达式。注意是相对光标所在位置前进一个表达式，如果要想相对当前停止点要先用w将光标移到当前停止点。edebug-forward-sexp<br/>
</li>
<li>o 跳出所在的表达式。edebug-step-out<br/>
</li>
<li>i 进入后面的函数或宏。edebug-step-in<br/>
</li>
<li>w 将光标移动到当前的停止点<br/>
</li>
</ol>

<p>  断点：<br/>
</p><ol>
<li>b 在停止点上设置断点,加前缀表示临时断点（只能用一次）。edebug-set-breakpoint<br/>
</li>
<li>u 取消断点。edebug-unset-breakpoint<br/>
</li>
<li>x Condition 条件断点，加前缀表临时断点。edebug-set-conditional-breakpoint<br/>
</li>
<li>B 移到下一个断点，只是移到光标到下一个断点并不执行。edebug-next-breakpoint.<br/>
</li>
<li>X 设置全局断点条件。在每个停止点都测试全局断点条件，如果为真则停止或暂停（依据所有模式而定）。<br/>
</li>
<li>源码断点，即断点写在源码里。<br/>



<pre class="src src-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">fac</span> (n)
 (<span style="color: #a020f0;">if</span> (= n 0) (edebug))
 (<span style="color: #a020f0;">if</span> (&lt; 0 n)
     (* n (fac (1- n)))
   1))
</pre>

</li>
</ol>

<p>  执行表达式：<br/>
</p><ol>
<li>e Exp RET edebug-eval-expression<br/>
</li>
<li>M-: EXP RET 与上面区别在于：前者在edebug环境外，而后者在edebug环境下执行。 eval-expression<br/>
</li>
<li>C-x C-e 求值当前点之前的表达式，在edebug环境外。edebug-eval-last-sexp<br/>
</li>
</ol>

<p>  其它：<br/>
</p><ol>
<li>q 退出Edebug。top-level<br/>
</li>
<li>d 显示backstrace. edebug-backstrace<br/>
</li>
<li>r 在回显区显示最近表达式结果。edebug-previous-result<br/>
</li>
<li>? 查看帮助. edebug-help<br/>
</li>
<li>v 切换回进入edebug之前的状态。edebug-view-outside<br/>
</li>
<li>p 时间切换回进入edebug之前的状态，时间为1秒,前缀为N则时间为N秒。edebug-bounce-point<br/>
</li>
</ol>

<p>  *Edebug*buffer<br/>
  E可进入*Edebug*buffer，在此buffer里可以进入表达式求值。<br/>
  C-j和C-x C-e都可以对当前点之前的表达式求值，区别在于前者结果显示在buffer中，后者结果显示在minbuffer中。<br/>
</p></div>

</div>

<div id="outline-container-14" class="outline-2">
<h2 id="sec-14"><span class="section-number-2">14</span> Tricks</h2>
<div class="outline-text-2" id="text-14">


</div>

<div id="outline-container-14-1" class="outline-3">
<h3 id="sec-14-1"><span class="section-number-3">14.1</span> 用or来替代if not</h3>
<div class="outline-text-3" id="text-14-1">

<p>   逻辑运算符and or 都是短路运算符，即遇到一个符合条件的就不再执行下面的语句，可以利用此特性来实现if not。<br/>
   (or A B) &lt;=&gt; (if (not A) B) 如果A为假则执行B<br/>
   例如一个函数的默认参数可以用此来实现，<br/>
</p>


<pre class="example">(defun fun(A &amp;optional B)
        (or B (setq B C))       ;如果没有B则设置B为C，否则 B不变
        ....
)
</pre>

</div>
</div>

</div>

<div id="outline-container-15" class="outline-2">
<h2 id="sec-15"><span class="section-number-2">15</span> 分享/评论</h2>
<div class="outline-text-2" id="text-15">


<a class="btn btn-primary" href="https://raw.github.com/visayafan/visayafan.github.com/master/Others/o/Elisp.org">查看Org源码</a>
<a class="bshareDiv" href="http://www.bshare.cn/share">分享按钮</a><script type="text/javascript" charset="utf-8" src="http://static.bshare.cn/b/buttonLite.js#uuid=&amp;style=10&amp;bgcolor=Blue"></script>
<br/>
<script src="../../Layout/JS/disqus-comment.js"></script>
<div id="disqus_thread">
</div>

</div>
</div>
</div>

</body>
</html>
